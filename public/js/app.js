var tuna={};tuna.VERSION="1.0.571",tuna.IS_IE=!!eval("'' == 'v'"),tuna.ui={},tuna.ui.buttons={},tuna.ui.flash={},tuna.ui.forms={},tuna.ui.popups={},tuna.ui.selection={},tuna.ui.selection.items={},tuna.ui.selection.rule={},tuna.ui.selection.view={},tuna.ui.transformers={},tuna.model={},tuna.rest={},tuna.control={},tuna.net={},tuna.dom={},tuna.events={},tuna.tmpl={},tuna.tmpl.compilers={},tuna.tmpl.data={},tuna.tmpl.markup={},tuna.tmpl.settings={},tuna.tmpl.units={},tuna.tmpl.units.list={},tuna.tmpl.units.condition={},tuna.utils={},tuna.utils.toArray=function(a){return Array.prototype.slice.call(a)},tuna.utils.dateToString=function(a){return a.toJSON().substring(0,16).replace("T"," ")},tuna.utils.extend=function(a,b){var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a},tuna.utils.eval=function(a){return window.execScript!==undefined?window.execScript(a):window.eval(a)},tuna.utils.bind=function(a,b){if(a.bind!==undefined)return a.bind(b);var c=Array.prototype.slice.call(arguments,2);return function(){return a.apply(b,c.concat(tuna.utils.toArray(arguments)))}},tuna.utils.nextTick=function(a){setTimeout(a,0)},tuna.utils.clone=function(a){return JSON.parse(JSON.stringify(a))},tuna.utils.cloneArray=function(a){return a.slice(0)},tuna.utils.isObjectsEquals=function(a,b){var c=a===b;if(!c&&a!==null&&b!==null){c=!0;for(var d in a)a[d]instanceof Object&&b[d]instanceof Object?c=c&&tuna.utils.isObjectsEquals(a[d],b[d]):c=c&&a[d]===b[d]}return c},tuna.utils.indexOf=function(a,b){if(b.indexOf!==undefined)return b.indexOf(a);var c=0,d=b.length;while(c<d){if(b[c]===a)return c;c++}return-1},tuna.utils.urlEncode=function(a){return tuna.utils.__splitUrlData(a).join("&")},tuna.utils.__splitUrlData=function(a,b){var c=[];b===undefined&&(b=[]);if(a!==null&&!(a instanceof Function))if(a instanceof Object)for(var d in a){var e=b.length===0?[d]:(b.join(",")+","+d).split(",");c=c.concat(tuna.utils.__splitUrlData(a[d],e))}else c=[b.shift()+(b.length>0?"["+b.join("][")+"]=":"=")+encodeURIComponent(""+a)];return c},tuna.utils.__DECODE_HELPER="|",tuna.utils.urlDecode=function(a){var b={},c=a.split("][").join(tuna.utils.__DECODE_HELPER);c=c.split("[").join(tuna.utils.__DECODE_HELPER),c=c.split("]").join("");var d=c.split("&"),e=0,f=d.length,g=null,h=null,i=null,j=null;while(e<f){g=d[e].split("="),h=g.shift().split(tuna.utils.__DECODE_HELPER),j=b;while(h.length>0)i=h.shift(),h.length===0?j[i]=decodeURIComponent(g.shift()):j[i]===undefined&&(j[i]={}),j=j[i];e++}return b};var Config=function(){this.__data=null};Config.prototype.init=function(a){this.__data=a},Config.prototype.get=function(a,b){return this.__data[a]!==undefined?b!==undefined?this.__data[a][b]||null:this.__data[a]:null},Config.prototype.set=function(a,b){this.__data[a]=b},tuna.utils.config=new Config,tuna.dom.setSelectorEngine=function(a){tuna.dom.__selectorEngine=a},tuna.dom.select=function(a,b){return tuna.dom.__selectorEngine!==null?tuna.dom.__selectorEngine(a,b):[]},tuna.dom.selectOne=function(a,b){if(tuna.dom.__selectorEngine!==null){var c=tuna.dom.__selectorEngine(a,b);if(c.length>0)return c[0]}return null},tuna.dom.matches=function(a,b){return tuna.dom.__selectorEngine!==null?tuna.dom.__selectorEngine.matches(a,b):[]},tuna.dom.matchesSelector=function(a,b){return tuna.dom.__selectorEngine!==null?tuna.dom.__selectorEngine.matchesSelector(a,b):!1},tuna.dom.__selectorEngine=null,tuna.dom.dispatchEvent=function(a,b){var c=!1,d=null;if(document.createEventObject!==undefined){d=document.createEventObject();var e="on"+b;a[e]===undefined?tuna.dom.__dispatchCustomIEEvent(a,d,b):c=a.fireEvent(e,d)}else d=document.createEvent("UIEvents"),d.initUIEvent(b,!0,!0,window,1),c=!a.dispatchEvent(d);return c},tuna.dom.addEventListener=function(a,b,c){if(a.addEventListener!==undefined)a.addEventListener(b,c,!1);else if(a.attachEvent!==undefined){var d="on"+b;if(a[d]===undefined)tuna.dom.__addCustomIEListener(a,b,c);else{a.__ieTargetId===undefined&&(a.__ieTargetId="element_"+tuna.dom.__lastElementId++);var e=a.__ieTargetId+"_"+b;c[e]=function(b){c.call(a,b)},a.attachEvent(d,c[e])}}},tuna.dom.removeEventListener=function(a,b,c){if(a.removeEventListener!==undefined)a.removeEventListener(b,c,!1);else if(a.detachEvent!==undefined){var d="on"+b;if(a[d]===undefined)tuna.dom.__removeCustomIEListener(a,b,c);else{var e=a.__ieTargetId+"_"+b;c[e]!==undefined&&(a.detachEvent("on"+b,c[e]),delete c[e])}}},tuna.dom.addOneEventListener=function(a,b,c){a.__onceTargetId===undefined&&(a.__onceTargetId="element_"+tuna.dom.__lastElementId++);var d=a.__onceTargetId+"_"+b;c[d]=function(d){c.call(a,d),tuna.dom.removeOneEventListener(a,b,c)},tuna.dom.addEventListener(a,b,c[d])},tuna.dom.removeOneEventListener=function(a,b,c){var d=a.__onceTargetId+"_"+b;c[d]!==undefined&&(tuna.dom.removeEventListener(a,b,c[d]),delete c[d])},tuna.dom.addChildEventListener=function(a,b,c,d){a.__childTargetId===undefined&&(a.__childTargetId="element_"+tuna.dom.__lastElementId++);var e=a.__childTargetId+"_"+c+"_"+b;d[e]=function(c){var e=c.target||c.srcElement,f=null;tuna.dom.matchesSelector(e,b)?f=e:f=tuna.dom.getParentMatches(e,b,a),f!==null&&(d.call(f,c),tuna.dom.stopPropagation(c))},tuna.dom.addEventListener(a,c,d[e])},tuna.dom.removeChildEventListener=function(a,b,c,d){var e=a.__childTargetId+"_"+c+"_"+b;d[e]!==undefined&&(tuna.dom.removeEventListener(a,c,d[e]),delete d[e])},tuna.dom.__addCustomIEListener=function(a,b,c){a.__customListener===undefined&&(a.__customListener=function(b){if(b.__type!==undefined){var c=b.__type;delete b.__type;var d=a["__"+c];for(var e in d)d[e].call(a,b)}},a.attachEvent("onhelp",a.__customListener)),a["__"+b]===undefined&&(a["__"+b]=[]),a["__"+b].push(c)},tuna.dom.__removeCustomIEListener=function(a,b,c){var d=a["__"+b];if(d!==undefined){var e=d.length-1;while(e>=0)d[e]===c&&d.splice(e,1),e--}},tuna.dom.__dispatchCustomIEEvent=function(a,b,c){return b.__type=c,a.fireEvent("onhelp",b)},tuna.dom.__lastElementId=0,tuna.dom.preventDefault=function(a){a.preventDefault!==undefined?a.preventDefault():a.returnValue=!1},tuna.dom.stopPropagation=function(a){a.stopPropagation!==undefined?a.stopPropagation():a.cancelBubble=!0},tuna.dom.getParentMatches=function(a,b,c){var d=a.parentNode;while(d!==null&&d!==c&&!tuna.dom.matchesSelector(d,b))d=d.parentNode;return d===c?null:d},tuna.dom.getParentWithClass=function(a,b,c){var d=a.parentNode;while(d!==null&&d!==c&&!tuna.dom.hasClass(d,b))d=d.parentNode;return d===c?null:d},tuna.dom.hasClass=function(a,b){if(a.classList!==undefined)return a.classList.contains(b);if(a.className!==undefined){var c=new RegExp("(\\s|^)"+b+"(\\s|$)");return a.className.match(c)!==null}return!1},tuna.dom.addClass=function(a,b){a.classList!==undefined?a.classList.add(b):tuna.dom.hasClass(a,b)||(a.className+=" "+b)},tuna.dom.removeClass=function(a,b){if(a.classList!==undefined)a.classList.remove(b);else if(tuna.dom.hasClass(a,b)){var c=new RegExp("(\\s|^)"+b+"(\\s|$)");a.className=a.className.replace(c," ")}},tuna.dom.setClassExist=function(a,b,c){!c&&tuna.dom.hasClass(a,b)?tuna.dom.removeClass(a,b):c&&!tuna.dom.hasClass(a,b)&&tuna.dom.addClass(a,b)},tuna.dom.getAttributesData=function(a){var b={},c="data-",d=a.attributes,e=0,f=d.length;while(e<f)d[e].name.indexOf(c)===0&&(b[d[e].name.substr(c.length)]=d[e].value),e++;return b},tuna.dom.createFragment=function(a){var b=document.createDocumentFragment(),c=document.createElement("div");c.innerHTML=a;var d=c.childNodes,e=0,f=d.length;while(e<f)b.appendChild(d.item(0)),e++;return b},tuna.events.BasicEvent=function(a,b,c){this._target=a,this._type=b,this._isBubbling=!!c,this._isCanceled=!1,this._isStopped=!1,this._isImmediateStopped=!1},tuna.events.BasicEvent.prototype.getTarget=function(){return this._target},tuna.events.BasicEvent.prototype.getType=function(){return this._type},tuna.events.BasicEvent.prototype.isBubbling=function(){return this._isBubbling},tuna.events.BasicEvent.prototype.preventDefault=function(){this._isCanceled=!0},tuna.events.BasicEvent.prototype.isDefaultPrevented=function(){return this._isCanceled},tuna.events.BasicEvent.prototype.stopImmediatePropagation=function(){this._isImmediateStopped=!0},tuna.events.BasicEvent.prototype.isImmediatePropagationStopped=function(){return this._isImmediateStopped},tuna.events.BasicEvent.prototype.stopPropagation=function(){this._isStopped=!0},tuna.events.BasicEvent.prototype.isPropagationStopped=function(){return this._isImmediateStopped||this._isStopped},tuna.events.IEventDispatcher=function(){},tuna.events.IEventDispatcher.prototype.dispatch=function(a,b){},tuna.events.IEventDispatcher.prototype.addEventListener=function(a,b){},tuna.events.IEventDispatcher.prototype.removeEventListener=function(a,b){},tuna.events.IEventDispatcher.prototype.hasEventListener=function(a,b){},tuna.events.EventDispatcher=function(a){this._propagationParent=a||null,this._listeners={}},tuna.events.EventDispatcher.prototype.dispatch=function(a,b){a instanceof tuna.events.BasicEvent||(a=new tuna.events.BasicEvent(this,a));var c=b!==undefined?b:null,d=a.getType();if(this._listeners[d]!==undefined){var e=0,f=this._listeners[d].length;while(e<f){this._listeners[d][e].call(this,a,c);if(a.isImmediatePropagationStopped())break;e++}this._propagationParent!==null&&a.isBubbling()&&!a.isPropagationStopped()&&this._propagationParent.dispatch(a)}return!a.isDefaultPrevented()},tuna.events.EventDispatcher.prototype.addEventListener=function(a,b){this._listeners[a]===undefined?this._listeners[a]=[b]:this.hasEventListener(a,b)||this._listeners[a].push(b)},tuna.events.EventDispatcher.prototype.removeEventListener=function(a,b){if(this._listeners[a]!==undefined){var c=tuna.utils.indexOf(b,this._listeners[a]);c!==-1&&this._listeners[a].splice(c,1)}},tuna.events.EventDispatcher.prototype.hasEventListener=function(a,b){return this._listeners[a]!==undefined?tuna.utils.indexOf(b,this._listeners[a])!==-1:!1},tuna.net.IRequest=function(){},tuna.utils.extend(tuna.net.IRequest,tuna.events.IEventDispatcher),tuna.net.IRequest.prototype.send=function(a){},tuna.net.IRequest.prototype.abort=function(){},tuna.net.Request=function(a,b){tuna.events.EventDispatcher.call(this),this.__url=a||"/",this.__isSync=!!b,this.__method=tuna.net.Request.METHOD_GET,this.__headers={},this.__data=null,this.__requests=[]},tuna.utils.extend(tuna.net.Request,tuna.events.EventDispatcher),tuna.net.Request.METHOD_GET="GET",tuna.net.Request.METHOD_POST="POST",tuna.net.Request.prototype.setURL=function(a){this.__url=a},tuna.net.Request.prototype.setData=function(a){this.__data=a},tuna.net.Request.prototype.setMethod=function(a){this.__method=a},tuna.net.Request.prototype.addHeader=function(a,b){this.__headers[a]=b},tuna.net.Request.prototype.removeHeader=function(a){delete this.__headers[a]},tuna.net.Request.prototype.send=function(a){a!==undefined&&(this.__data=a);var b=tuna.IS_IE?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest;if(!this.__isSync){var c=this;b.onreadystatechange=function(){b.readyState===4&&(c.dispatch("complete",b.responseText),c.__removeRequest(b),b.abort())}}for(var d in this.__headers)b.setRequestHeader(d,this.__headers[d]);var e=this.__url,f=tuna.utils.urlEncode(this.__data);this.__method===tuna.net.Request.METHOD_GET&&f.length!==0&&(e+=(e.indexOf("?")===-1?"?":"&")+f),b.open(this.__method,encodeURI(e),!this.__isSync);var g=null;this.__method!==tuna.net.Request.METHOD_GET&&(b.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),g=f),b.send(g),this.__isSync?this.dispatch("complete",b.responseText):this.__requests.push(b)},tuna.net.Request.prototype.abort=function(){while(this.__requests.length>0)this.__requests.shift().abort()},tuna.net.Request.prototype.__removeRequest=function(a){var b=0,c=this.__requests.length;while(b<c)this.__requests[b]===a&&this.__requests.splice(b,1),b++},tuna.model.IResource=function(){},tuna.model.IResource.prototype.clear=function(){},tuna.model.ListResource=function(a,b){tuna.events.EventDispatcher.call(this),this.__lastArgs=null,this._methodName=a||null,this._recordName=b||null,this._list=[]},tuna.utils.extend(tuna.model.ListResource,tuna.events.EventDispatcher),tuna.model.ListResource.prototype.load=function(a,b){if(this._methodName!==null&&this._recordName!==null){if(b||a===undefined||!tuna.utils.isObjectsEquals(this.__lastArgs,a)){var c=this;tuna.rest.call(this._methodName,a||null,function(a){c.set(a)},this._recordName)}this.__lastArgs=a||null}},tuna.model.ListResource.prototype.set=function(a){this._list!==a&&(this._list=a,this.dispatch("update",this._list))},tuna.model.ListResource.prototype.get=function(){return this._list},tuna.model.ListResource.prototype.clear=function(){this._list.length>0&&(this._list.length=0,this.dispatch("update",this._list))},tuna.model.ListResource.prototype.addItem=function(a){var b=0,c=this._list.length;while(b<c){if(this._list[b].id===a.id)break;b++}this._list[b]=a,this.dispatch("update",this._list)},tuna.model.ListResource.prototype.removeItem=function(a){a.id!==null&&this.removeItemById(a.id)},tuna.model.ListResource.prototype.removeItemById=function(a){var b=0,c=this._list.length;while(b<c){if(this._list[b].id===a){this._list.splice(b,1),this.dispatch("update",this._list);break}b++}},tuna.model.ListResource.prototype.getItemById=function(a){var b=0,c=this._list.length;while(b<c){if(this._list[b].id===a)return this._list[b];b++}return null},tuna.model.ListResource.prototype.find=function(a){var b=[],c=0,d=this._list.length;while(c<d)a(this._list[c])&&b.push(this._list[c]),c++;return b},tuna.model.ListResource.prototype.findOne=function(a){var b=0,c=this._list.length;while(b<c){if(a(this._list[b]))return this._list[b];b++}return null},tuna.model.ListResource.prototype.each=function(a){var b=0,c=this._list.length;while(b<c)a(this._list[b]),b++},tuna.model.ListResource.prototype.map=function(a){var b=[],c=0,d=this._list.length,e=null;while(c<d)e=a(this._list[c]),e!==null&&b.push(e),c++;return b},tuna.model.ItemResource=function(){tuna.events.EventDispatcher.call(this),this._item=null},tuna.utils.extend(tuna.model.ItemResource,tuna.events.EventDispatcher),tuna.model.ItemResource.prototype.set=function(a){this._item!==a&&(this._item=a,this.dispatch("update",this._item))},tuna.model.ItemResource.prototype.get=function(){return this._item},tuna.model.ItemResource.prototype.clear=function(){this.set(null)},tuna.model.RecordFactory=function(){this.__prototypes={}},tuna.model.RecordFactory.prototype.registerRecord=function(a,b){this.__prototypes[a]=b},tuna.model.RecordFactory.prototype.getRecordPrototype=function(a){return this.__prototypes[a]||null},tuna.model.RecordFactory.prototype.createRecord=function(a){return this.__prototypes[a]!==undefined?this.__prototypes[a].clone():null},tuna.model.Record=function(a){this.id=null,a!==undefined&&this.populate(a)},tuna.model.Record.prototype.clone=function(){var a=new this.constructor;for(var b in this)a[b]=this[b];return a},tuna.model.Record.prototype.populate=function(a){},tuna.model.Record.prototype.serialize=function(a){},tuna.model.serialize=function(a,b){if(a instanceof Array){var c=[],d=0,e=a.length;while(d<e)c.push(a[d].serialize(b)),d++;return c}return a instanceof tuna.model.Record?a.serialize(b):null},tuna.model.recordFactory=new tuna.model.RecordFactory,tuna.rest.IMethod=function(){},tuna.rest.IMethod.prototype.call=function(a){},tuna.rest.IMethod.prototype.clone=function(a){},tuna.rest.Method=function(){tuna.events.EventDispatcher.call(this)},tuna.utils.extend(tuna.rest.Method,tuna.events.EventDispatcher),tuna.rest.Method.prototype.call=function(a){},tuna.rest.Method.prototype.clone=function(){return new this.constructor},tuna.rest.DefaultMethod=function(a){tuna.rest.Method.call(this),a!==undefined&&this.setName(a)},tuna.utils.extend(tuna.rest.DefaultMethod,tuna.rest.Method),tuna.rest.DefaultMethod.prototype.setName=function(a){},tuna.rest.IMethodFactory=function(){},tuna.rest.IMethodFactory.prototype.createMethod=function(a){},tuna.rest.MethodFactory=function(){this.__methods={},this.__defaultMethod=null},tuna.rest.MethodFactory.prototype.setDefaultMethod=function(a){this.__defaultMethod=a},tuna.rest.MethodFactory.prototype.createMethod=function(a){var b=null;return this.__methods[a]!==undefined?b=this.__methods[a].clone():this.__defaultMethod!==null&&(b=this.__defaultMethod.clone(),b.setName(a)),b},tuna.rest.MethodFactory.prototype.registerMethod=function(a,b){this.__methods[a]=b},tuna.rest.call=function(a,b,c,d){var e=tuna.rest.methodFactory.createMethod(a),f=null;c!==undefined&&(d===undefined?f=function(a,b){c(b),e.removeEventListener("result",f)}:f=function(a,b){d!==undefined&&c(tuna.rest.populateRecords(b,d)),e.removeEventListener("result",f)}),f!==null&&e.addEventListener("result",f),e.call(b)},tuna.rest.populateRecords=function(a,b){var c=tuna.model.recordFactory.getRecordPrototype(b);if(c!==null&&a!==null){var d=null;if(a instanceof Array){var e=[],f=0,g=a.length;while(f<g)d=c.clone(),a[f]!==null&&d.populate(a[f]),e.push(d),f++;return e}return d=c.clone(),d.populate(a),d}return null},tuna.rest.methodFactory=new tuna.rest.MethodFactory,tuna.tmpl.data.DataNode=function(a,b,c){this.__value=a,this.__parent=b||tuna.tmpl.data.NULL_NODE,this.__key=c||null,this.__keyNode=null,this.__children={}},tuna.tmpl.data.DataNode.prototype.getParent=function(){return this.__parent},tuna.tmpl.data.DataNode.prototype.getKey=function(){return this.__keyNode===null&&(this.__keyNode=new tuna.tmpl.data.DataNode(this.__key)),this.__keyNode},tuna.tmpl.data.DataNode.prototype.getRoot=function(){return this.__parent!==tuna.tmpl.data.NULL_NODE?this.__parent.getRoot():this},tuna.tmpl.data.DataNode.prototype.getValue=function(){return this.__value},tuna.tmpl.data.DataNode.prototype.getStringValue=function(){return this.__value!==null?this.__value.toString():null},tuna.tmpl.data.DataNode.prototype.growChild=function(a){return this===tuna.tmpl.data.NULL_NODE?this:(this.__children[a]===undefined&&(this.__value!==null&&this.__value[a]!==undefined?this.__children[a]=new tuna.tmpl.data.DataNode(this.__value[a],this,a):this.__children[a]=tuna.tmpl.data.NULL_NODE),this.__children[a])},tuna.tmpl.data.NULL_NODE=new tuna.tmpl.data.DataNode(null),tuna.tmpl.data.PathEvaluator=function(){this.__parsedPath=null},tuna.tmpl.data.PathEvaluator.prototype.setPath=function(a){this.__parsedPath=a.split("/")},tuna.tmpl.data.PathEvaluator.prototype.evaluate=function(a){return this.__parsedPath!==null?this.__applyNextToken(this.__parsedPath,a,0):tuna.tmpl.data.NULL_NODE},tuna.tmpl.data.PathEvaluator.prototype.__applyNextToken=function(a,b,c){var d=a[c];return d!==undefined&&b!==tuna.tmpl.data.NULL_NODE?this.__applyNextToken(a,this.__applyToken(d,b),++c):b},tuna.tmpl.data.PathEvaluator.prototype.__applyToken=function(a,b){switch(a){case"":return b.getRoot();case".":return b;case"..":return b.getParent();case"$key":return b.getKey()}return b.growChild(a)},tuna.tmpl.settings.IItemSettings=function(){},tuna.tmpl.settings.IItemSettings.prototype.getType=function(){},tuna.tmpl.settings.SpotSettings=function(a,b){this.targetSelector=a,this.dataPath=b,this.pattern=null},tuna.tmpl.settings.SpotSettings.prototype.getType=function(){return tuna.tmpl.units.Spot.NAME},tuna.tmpl.settings.AttributeSettings=function(a,b,c){tuna.tmpl.settings.SpotSettings.call(this,a,b),this.attributeName=c,this.hasEvent=!1},tuna.utils.extend(tuna.tmpl.settings.AttributeSettings,tuna.tmpl.settings.SpotSettings),tuna.tmpl.settings.AttributeSettings.prototype.getType=function(){return tuna.tmpl.units.Attribute.NAME},tuna.tmpl.settings.ConditionSettings=function(a,b,c,d){tuna.tmpl.settings.SpotSettings.call(this,a,b),this.actionType=c,this.operatorType=d,this.actionData="",this.operatorData=""},tuna.utils.extend(tuna.tmpl.settings.ConditionSettings,tuna.tmpl.settings.SpotSettings),tuna.tmpl.settings.ConditionSettings.prototype.getType=function(){return tuna.tmpl.units.Condition.NAME},tuna.tmpl.settings.CheckboxSettings=function(a,b){tuna.tmpl.settings.SpotSettings.call(this,a,b)},tuna.utils.extend(tuna.tmpl.settings.CheckboxSettings,tuna.tmpl.settings.SpotSettings),tuna.tmpl.settings.CheckboxSettings.prototype.getType=function(){return tuna.tmpl.units.Checkbox.NAME},tuna.tmpl.settings.ListSettings=function(a,b,c,d,e){tuna.tmpl.settings.SpotSettings.call(this,a,b),this.keyPath=c,this.itemRendererID=d,this.itemSettings=e},tuna.utils.extend(tuna.tmpl.settings.ListSettings,tuna.tmpl.settings.SpotSettings),tuna.tmpl.settings.ListSettings.prototype.getType=function(){return tuna.tmpl.units.List.NAME},tuna.tmpl.settings.TemplateSettings=function(){this.__items=[]},tuna.tmpl.settings.TemplateSettings.prototype.additems=function(a){this.__items=this.__items.concat(a)},tuna.tmpl.settings.TemplateSettings.prototype.getItemsCount=function(){return this.__items.length},tuna.tmpl.settings.TemplateSettings.prototype.getItemAt=function(a){return this.__items[a]},tuna.tmpl.settings.TemplateSettings.prototype.getType=function(){return tuna.tmpl.units.Template.NAME},tuna.tmpl.markup.IMarkupExtractor=function(){},tuna.tmpl.markup.IMarkupExtractor.prototype.extract=function(a){},tuna.tmpl.markup.SpotExtractor=function(){this._tagName="spot",this._ns="tuna:"},tuna.tmpl.markup.SpotExtractor.prototype.extract=function(a){var b=[],c=tuna.IS_IE?this._tagName:this._ns+this._tagName,d=a.getElementsByTagName(c),e=0,f=d.length,g=null;while(e<f)g=this._createItem(d[e]),g!==null&&b.push(g),e++;return b},tuna.tmpl.markup.SpotExtractor.prototype._createItem=function(a){var b=a.getAttribute(this._ns+"target"),c=a.getAttribute(this._ns+"path");if(b!==null&&c!==null){var d=new tuna.tmpl.settings.SpotSettings(b,c);return d.pattern=a.getAttribute(this._ns+"pattern"),d}return null},tuna.tmpl.markup.ListExtractor=function(a){tuna.tmpl.markup.SpotExtractor.call(this),this._tagName="list",this.__templateBuilder=a},tuna.utils.extend(tuna.tmpl.markup.ListExtractor,tuna.tmpl.markup.SpotExtractor),tuna.tmpl.markup.ListExtractor.prototype._createItem=function(a){var b=a.getAttribute(this._ns+"target"),c=a.getAttribute(this._ns+"path"),d=a.getAttribute(this._ns+"key-path"),e=a.getAttribute(this._ns+"item-renderer-id"),f=null,g=a.getAttribute(this._ns+"item-template-id");g!==null&&(f=this.__templateBuilder.buildSettings(g));if(b!==null&&c!==null&&d!==null&&e!==null&&f!==null){var h=new tuna.tmpl.settings.ListSettings(b,c,d,e,f);return h.pattern=a.getAttribute(this._ns+"pattern"),h}return null},tuna.tmpl.markup.AttributeExtractor=function(){tuna.tmpl.markup.SpotExtractor.call(this),this._tagName="attr"},tuna.utils.extend(tuna.tmpl.markup.AttributeExtractor,tuna.tmpl.markup.SpotExtractor),tuna.tmpl.markup.AttributeExtractor.prototype._createItem=function(a){var b=a.getAttribute(this._ns+"target"),c=a.getAttribute(this._ns+"path"),d=a.getAttribute(this._ns+"name");if(b!==null&&c!==null&&d!==null){var e=new tuna.tmpl.settings.AttributeSettings(b,c,d);return e.pattern=a.getAttribute(this._ns+"pattern"),e.hasEvent=!!a.getAttribute(this._ns+"event"),e}return null},tuna.tmpl.markup.ConditionExtractor=function(){tuna.tmpl.markup.SpotExtractor.call(this),this._tagName="if",this.__operators=[],this.__actions=[]},tuna.utils.extend(tuna.tmpl.markup.ConditionExtractor,tuna.tmpl.markup.SpotExtractor),tuna.tmpl.markup.ConditionExtractor.prototype.addOperatorType=function(a){this.__operators.push(a)},tuna.tmpl.markup.ConditionExtractor.prototype.addActionType=function(a){this.__actions.push(a)},tuna.tmpl.markup.ConditionExtractor.prototype._createItem=function(a){var b=a.getAttribute(this._ns+"target"),c=a.getAttribute(this._ns+"path"),d=this.__extractActionAttribute(a),e=this.__extractOperatorAttribute(a);if(b!==null&&c!==null&&d!==null&&e!==null){var f=d.name.substr(this._ns.length),g=e.name.substr(this._ns.length),h=new tuna.tmpl.settings.ConditionSettings(b,c,f,g);return h.pattern=a.getAttribute(this._ns+"pattern"),h.actionData=d.value,h.operatorData=e.value,h}return null},tuna.tmpl.markup.ConditionExtractor.prototype.__extractActionAttribute=function(a){var b=null;for(var c in this.__actions){b=this._ns+this.__actions[c];if(a.attributes[b])return a.attributes[b]}return null},tuna.tmpl.markup.ConditionExtractor.prototype.__extractOperatorAttribute=function(a){var b=null;for(var c in this.__operators){b=this._ns+this.__operators[c];if(a.attributes[b])return a.attributes[b]}return null},tuna.tmpl.markup.CheckboxExtractor=function(){tuna.tmpl.markup.SpotExtractor.call(this),this._tagName="checkbox"},tuna.utils.extend(tuna.tmpl.markup.CheckboxExtractor,tuna.tmpl.markup.SpotExtractor),tuna.tmpl.markup.CheckboxExtractor.prototype._createItem=function(a){var b=a.getAttribute(this._ns+"target"),c=a.getAttribute(this._ns+"path");if(b!==null&&c!==null){var d=new tuna.tmpl.settings.CheckboxSettings(b,c);return d.pattern=a.getAttribute(this._ns+"pattern"),d}return null},tuna.tmpl.markup.MarkupTemplateBuilder=function(){this.__templatesTable={},this.__extractors=[]},tuna.tmpl.markup.MarkupTemplateBuilder.prototype.addExtractor=function(a){this.__extractors.push(a)},tuna.tmpl.markup.MarkupTemplateBuilder.prototype.buildSettings=function(a){if(this.__templatesTable[a]===undefined){var b=document.getElementById(a);if(b!==null){var c=new tuna.tmpl.settings.TemplateSettings,d=0,e=this.__extractors.length,f=null;while(d<e)f=this.__extractors[d].extract(b),f!==null&&c.additems(f),d++;this.__templatesTable[a]=c}}return this.__templatesTable[a]||null},tuna.tmpl.units.list.IListItemRouter=function(){},tuna.tmpl.units.list.IListItemRouter.prototype.append=function(a){},tuna.tmpl.units.list.IListItemRouter.prototype.remove=function(a){},tuna.tmpl.units.list.ListContainerRouter=function(a,b){this._container=a,this._rootTemplate=b},tuna.tmpl.units.list.ListContainerRouter.prototype.append=function(a){this._container.appendChild(a),this._rootTemplate.registerChildCreation(a)},tuna.tmpl.units.list.ListContainerRouter.prototype.remove=function(a){this._container.removeChild(a),this._rootTemplate.registerChildRemoval(a)},tuna.tmpl.units.condition.ConditionAction=function(a){this._data=a||""},tuna.tmpl.units.condition.ConditionAction.prototype.apply=function(a,b,c){},tuna.tmpl.units.condition.ConditionAction.prototype.clone=function(a){return new this.constructor(a)},tuna.tmpl.units.condition.ClassAction=function(a){tuna.tmpl.units.condition.ConditionAction.call(this,a)},tuna.utils.extend(tuna.tmpl.units.condition.ClassAction,tuna.tmpl.units.condition.ConditionAction),tuna.tmpl.units.condition.ClassAction.NAME="class",tuna.tmpl.units.condition.ClassAction.prototype.apply=function(a,b,c){tuna.dom.setClassExist(a,this._data,b)},tuna.tmpl.units.condition.ConditionOperator=function(a){this._data=a||""},tuna.tmpl.units.condition.ConditionOperator.prototype.test=function(a){},tuna.tmpl.units.condition.ConditionOperator.prototype.clone=function(a){return new this.constructor(a)},tuna.tmpl.units.condition.EqualsOperator=function(a){tuna.tmpl.units.condition.ConditionOperator.call(this,a)},tuna.utils.extend(tuna.tmpl.units.condition.EqualsOperator,tuna.tmpl.units.condition.ConditionOperator),tuna.tmpl.units.condition.EqualsOperator.NAME="eq",tuna.tmpl.units.condition.EqualsOperator.prototype.test=function(a){return a===this._data||a+""===this._data},tuna.tmpl.units.condition.IsSetOperator=function(){tuna.tmpl.units.condition.ConditionOperator.call(this)},tuna.utils.extend(tuna.tmpl.units.condition.IsSetOperator,tuna.tmpl.units.condition.ConditionOperator),tuna.tmpl.units.condition.IsSetOperator.NAME="isset",tuna.tmpl.units.condition.IsSetOperator.prototype.test=function(a){return a!=null},tuna.tmpl.units.condition.NotEqualsOperator=function(a){tuna.tmpl.units.condition.ConditionOperator.call(this,a)},tuna.utils.extend(tuna.tmpl.units.condition.NotEqualsOperator,tuna.tmpl.units.condition.ConditionOperator),tuna.tmpl.units.condition.NotEqualsOperator.NAME="ne",tuna.tmpl.units.condition.NotEqualsOperator.prototype.test=function(a){return a!=this._data&&a+""!=this._data},tuna.tmpl.units.condition.NotSetOperator=function(){tuna.tmpl.units.condition.ConditionOperator.call(this)},tuna.utils.extend(tuna.tmpl.units.condition.NotSetOperator,tuna.tmpl.units.condition.ConditionOperator),tuna.tmpl.units.condition.NotSetOperator.NAME="notset",tuna.tmpl.units.condition.NotSetOperator.prototype.test=function(a){return a==null},tuna.tmpl.units.IUnit=function(){},tuna.tmpl.units.IUnit.prototype.applyData=function(a){},tuna.tmpl.units.IUnit.prototype.destroy=function(){},tuna.tmpl.units.Unit=function(a){this._rootTemplate=a},tuna.tmpl.units.Unit.prototype.applyData=function(a){},tuna.tmpl.units.Unit.prototype.destroy=function(){},tuna.tmpl.units.Spot=function(a){tuna.tmpl.units.Unit.call(this,a),this.__pathEvaluator=new tuna.tmpl.data.PathEvaluator,this._nodes=[],this._pattern=null},tuna.utils.extend(tuna.tmpl.units.Spot,tuna.tmpl.units.Unit),tuna.tmpl.units.Spot.NAME="spot",tuna.tmpl.units.Spot.prototype.setPattern=function(a){this._pattern=a},tuna.tmpl.units.Spot.prototype.setPath=function(a){this.__pathEvaluator.setPath(a)},tuna.tmpl.units.Spot.prototype.addTargets=function(a){this._nodes=this._nodes.concat(a)},tuna.tmpl.units.Spot.prototype.applyData=function(a){var b=this.__pathEvaluator.evaluate(a).getValue();this._pattern!==null&&b!==null&&(b=this._pattern.join(b)),this._applyValue(b)},tuna.tmpl.units.Spot.prototype._applyValue=function(a){var b="";a!==null&&(b=a.toString());var c=this._nodes.length-1;while(c>=0)this._nodes[c].innerHTML!==b&&(this._nodes[c].innerHTML=b),c--},tuna.tmpl.units.Spot.prototype.destroy=function(){this._nodes.length=0},tuna.tmpl.units.Attribute=function(a,b){tuna.tmpl.units.Spot.call(this,a),this.__attributeName=b,this.__hasEvent=!1,this.__dispatchAttribute=tuna.utils.bind(this.__dispatchAttribute,this)},tuna.utils.extend(tuna.tmpl.units.Attribute,tuna.tmpl.units.Spot),tuna.tmpl.units.Attribute.NAME="attribute",tuna.tmpl.units.Attribute.prototype.setEvent=function(a){this.__hasEvent=a},tuna.tmpl.units.Attribute.prototype._applyValue=function(a){a!==null?this.__setAttribute(a):this.__removeAttribute(),this.__hasEvent&&tuna.utils.nextTick(this.__dispatchAttribute)},tuna.tmpl.units.Attribute.prototype.__setAttribute=function(a){var b=this._nodes.length-1;while(b>=0)this._nodes[b][this.__attributeName]!==undefined&&(this._nodes[b][this.__attributeName]=a),this._nodes[b].setAttribute(this.__attributeName,a+""),b--},tuna.tmpl.units.Attribute.prototype.__removeAttribute=function(){var a=this._nodes.length-1;while(a>=0)this._nodes[a][this.__attributeName]!==undefined&&(this._nodes[a][this.__attributeName]=""),this._nodes[a].removeAttribute(this.__attributeName),a--},tuna.tmpl.units.Attribute.prototype.__dispatchAttribute=function(){var a=this._nodes.length-1;while(a>=0)tuna.dom.dispatchEvent(this._nodes[a],this.__attributeName),a--},tuna.tmpl.units.Condition=function(a,b,c){tuna.tmpl.units.Spot.call(this,a),this.__action=b,this.__operator=c},tuna.utils.extend(tuna.tmpl.units.Condition,tuna.tmpl.units.Spot),tuna.tmpl.units.Condition.NAME="condition",tuna.tmpl.units.Condition.prototype._applyValue=function(a){var b=this.__operator.test(a),c=this._nodes.length-1;while(c>=0)this.__action.apply(this._nodes[c],b,a),c--},tuna.tmpl.units.Checkbox=function(a){tuna.tmpl.units.Spot.call(this,a),this.__value=null,this.__applyChanges=tuna.utils.bind(this.__applyChanges,this)},tuna.utils.extend(tuna.tmpl.units.Checkbox,tuna.tmpl.units.Spot),tuna.tmpl.units.Checkbox.NAME="checkbox",tuna.tmpl.units.Checkbox.prototype._applyValue=function(a){this.__value=a,tuna.utils.nextTick(this.__applyChanges)},tuna.tmpl.units.Checkbox.prototype.__applyChanges=function(){var a=this.__value;if(a!==null){var b=this._nodes.length-1;if(a===!0||a===!1)while(b>=0)this._nodes[b].checked=a,b--;else if(a instanceof Array)while(b>=0)this._nodes[b].checked=tuna.utils.indexOf(this._nodes[b].value,a)!==-1,b--;else{a+="";while(b>=0)this._nodes[b].checked=this._nodes[b].value===a,b--}}this.__value=null},tuna.tmpl.units.List=function(a){tuna.tmpl.units.Unit.call(this,a),this.__templateCompiler=null,this.__itemRenderer=null,this.__itemSettings=null,this.__itemsTable={},this.__pathEvaluator=new tuna.tmpl.data.PathEvaluator,this.__keyPathEvaluator=new tuna.tmpl.data.PathEvaluator,this.__listNodeRouter=null},tuna.utils.extend(tuna.tmpl.units.List,tuna.tmpl.units.Unit),tuna.tmpl.units.List.NAME="list",tuna.tmpl.units.List.prototype.setListNodeRouter=function(a){this.__listNodeRouter=a},tuna.tmpl.units.List.prototype.setPath=function(a){this.__pathEvaluator.setPath(a)},tuna.tmpl.units.List.prototype.setKeyPath=function(a){this.__keyPathEvaluator.setPath(a)},tuna.tmpl.units.List.prototype.setCompiler=function(a){this.__templateCompiler=a},tuna.tmpl.units.List.prototype.setItemRenderer=function(a){this.__itemRenderer=a},tuna.tmpl.units.List.prototype.setItemSettings=function(a){this.__itemSettings=a},tuna.tmpl.units.List.prototype.applyData=function(a){var b=this.__itemsTable;this.__itemsTable={};var c=this.__pathEvaluator.evaluate(a),d=c.getValue(),e=null,f=null,g=null;for(var h in d)e=null,f=c.growChild(h),g=this.__keyPathEvaluator.evaluate(f).getStringValue(),g!==null&&(b[g]===undefined?e=this.__makeItemTemplate():(e=b[g],delete b[g]),e!==null&&(e.applyData(f),this.__itemsTable[g]=e));this.__removeItems(b)},tuna.tmpl.units.List.prototype.destroy=function(){for(var a in this.__itemsTable)this.__itemsTable[a].destroy();this.__itemsTable={}},tuna.tmpl.units.List.prototype.__removeItems=function(a){var b=null,c=null;for(var d in a)b=a[d],c=b.getTarget(),c!==null&&this.__listNodeRouter.remove(c),b.destroy()},tuna.tmpl.units.List.prototype.__makeItemTemplate=function(){var a=this.__itemRenderer.cloneNode(!0);return a!==null&&this.__itemSettings!==null?(this.__listNodeRouter.append(a),this.__templateCompiler.compile(this.__itemSettings,a,this._rootTemplate)):null},tuna.tmpl.units.Template=function(a){tuna.tmpl.units.Unit.call(this,a||this),this.__items=[],this.__createdChildren=[],this.__removedChildren=[],this.__target=null},tuna.utils.extend(tuna.tmpl.units.Template,tuna.tmpl.units.Unit),tuna.tmpl.units.Template.NAME="template",tuna.tmpl.units.Template.prototype.getRootTemplate=function(){return this._rootTemplate},tuna.tmpl.units.Template.prototype.setTarget=function(a){this.__target=a},tuna.tmpl.units.Template.prototype.getTarget=function(){return this.__target},tuna.tmpl.units.Template.prototype.addItems=function(a){this.__items=this.__items.concat(a)},tuna.tmpl.units.Template.prototype.registerChildCreation=function(a){this.__createdChildren=this.__createdChildren.concat(a)},tuna.tmpl.units.Template.prototype.fetchCreatedChildren=function(){return this.__createdChildren.splice(0,this.__createdChildren.length)},tuna.tmpl.units.Template.prototype.registerChildRemoval=function(a){this.__removedChildren=this.__removedChildren.concat(a)},tuna.tmpl.units.Template.prototype.fetchRemovedChildren=function(){return this.__removedChildren.splice(0,this.__removedChildren.length)},tuna.tmpl.units.Template.prototype.applyData=function(a){var b=this.__items.length-1;while(b>=0)this.__items[b].applyData(a),b--},tuna.tmpl.units.Template.prototype.destroy=function(){while(this.__items.length>0)this.__items.shift().destroy();this.__target=null},tuna.tmpl.compilers.IItemCompiler=function(){},tuna.tmpl.compilers.IItemCompiler.prototype.compile=function(a,b,c){},tuna.tmpl.compilers.TemplateCompiler=function(){this.__itemCompilers={}},tuna.tmpl.compilers.TemplateCompiler.prototype.registerCompiler=function(a,b){this.__itemCompilers[a]=b},tuna.tmpl.compilers.TemplateCompiler.prototype.compile=function(a,b,c){var d=new tuna.tmpl.units.Template(c);d.setTarget(b);var e=0,f=a.getItemsCount(),g=c||d,h=null,i=null,j=null;while(e<f)j=a.getItemAt(e),i=this.__itemCompilers[j.getType()],i!==undefined&&(h=i.compile(b,j,g),h!==null&&d.addItems(h)),e++;return d},tuna.tmpl.compilers.SpotCompiler=function(){},tuna.tmpl.compilers.SpotCompiler.prototype.compile=function(a,b,c){if(b instanceof tuna.tmpl.settings.SpotSettings){var d=new tuna.tmpl.units.Spot(c);return this._setupSpot(a,d,b),d}return null},tuna.tmpl.compilers.SpotCompiler.prototype._setupSpot=function(a,b,c){b.setPath(c.dataPath),c.pattern!==null&&b.setPattern(c.pattern.split("$$"));var d=c.targetSelector;tuna.dom.matchesSelector(a,d)?b.addTargets(a):b.addTargets(tuna.dom.select(d,a))},tuna.tmpl.compilers.AttributeCompiler=function(){tuna.tmpl.compilers.SpotCompiler.call(this)},tuna.utils.extend(tuna.tmpl.compilers.AttributeCompiler,tuna.tmpl.compilers.SpotCompiler),tuna.tmpl.compilers.AttributeCompiler.prototype.compile=function(a,b,c){if(b instanceof tuna.tmpl.settings.AttributeSettings){var d=new tuna.tmpl.units.Attribute(c,b.attributeName);return this._setupSpot(a,d,b),d.setEvent(b.hasEvent),d}return null},tuna.tmpl.compilers.ConditionCompiler=function(){tuna.tmpl.compilers.SpotCompiler.call(this),this.__actions={},this.__operators={}},tuna.utils.extend(tuna.tmpl.compilers.ConditionCompiler,tuna.tmpl.compilers.SpotCompiler),tuna.tmpl.compilers.ConditionCompiler.prototype.registerAction=function(a,b){this.__actions[a]=b},tuna.tmpl.compilers.ConditionCompiler.prototype.registerOperator=function(a,b){this.__operators[a]=b},tuna.tmpl.compilers.ConditionCompiler.prototype.compile=function(a,b,c){if(b instanceof tuna.tmpl.settings.ConditionSettings){var d=this.__actions[b.actionType],e=this.__operators[b.operatorType];if(d!==undefined&&e!==undefined){var f=d.clone(b.actionData),g=e.clone(b.operatorData),h=new tuna.tmpl.units.Condition(c,f,g);return this._setupSpot(a,h,b),h}}return null},tuna.tmpl.compilers.CheckboxCompiler=function(){tuna.tmpl.compilers.SpotCompiler.call(this)},tuna.utils.extend(tuna.tmpl.compilers.CheckboxCompiler,tuna.tmpl.compilers.SpotCompiler),tuna.tmpl.compilers.CheckboxCompiler.prototype.compile=function(a,b,c){if(b instanceof tuna.tmpl.settings.CheckboxSettings){var d=new tuna.tmpl.units.Checkbox(c);return this._setupSpot(a,d,b),d}return null},tuna.tmpl.compilers.ListCompiler=function(a){this.__templateCompiler=a},tuna.tmpl.compilers.ListCompiler.prototype.compile=function(a,b,c){if(b instanceof tuna.tmpl.settings.ListSettings){var d=document.getElementById(b.itemRendererID);if(d!==null){d=d.cloneNode(!0),d.removeAttribute("id");var e=b.targetSelector;if(tuna.dom.matchesSelector(a,e))return this.__compileList(a,d,b,c);var f=[],g=tuna.dom.select(e,a),h=g.length-1;while(h>=0)tuna.dom.getParentMatches(g[h],e,a)===null&&f.push(this.__compileList(g[h],d,b,c)),h--;return f}throw'Cannot find item renderer with id: "'+b.itemRendererID+'"'}return null},tuna.tmpl.compilers.ListCompiler.prototype.__compileList=function(a,b,c,d){var e=new tuna.tmpl.units.List(d);return e.setCompiler(this.__templateCompiler),e.setItemRenderer(b),e.setItemSettings(c.itemSettings),e.setKeyPath(c.keyPath),e.setPath(c.dataPath),e.setListNodeRouter(this.__createRouter(a,d,"")),e},tuna.tmpl.compilers.ListCompiler.prototype.__createRouter=function(a,b,c){return new tuna.tmpl.units.list.ListContainerRouter(a,b)},tuna.tmpl.compile=function(a,b){return tuna.tmpl.getCompiler().compile(b,a)},tuna.tmpl.getCompiler=function(){if(tuna.tmpl.__compiler===null){tuna.tmpl.__compiler=new tuna.tmpl.compilers.TemplateCompiler,tuna.tmpl.__compiler.registerCompiler(tuna.tmpl.units.Spot.NAME,new tuna.tmpl.compilers.SpotCompiler),tuna.tmpl.__compiler.registerCompiler(tuna.tmpl.units.Attribute.NAME,new tuna.tmpl.compilers.AttributeCompiler),tuna.tmpl.__compiler.registerCompiler(tuna.tmpl.units.Checkbox.NAME,new tuna.tmpl.compilers.CheckboxCompiler),tuna.tmpl.__compiler.registerCompiler(tuna.tmpl.units.List.NAME,new tuna.tmpl.compilers.ListCompiler(tuna.tmpl.__compiler));var a=new tuna.tmpl.compilers.ConditionCompiler;a.registerAction(tuna.tmpl.units.condition.ClassAction.NAME,new tuna.tmpl.units.condition.ClassAction),a.registerOperator(tuna.tmpl.units.condition.IsSetOperator.NAME,new tuna.tmpl.units.condition.IsSetOperator),a.registerOperator(tuna.tmpl.units.condition.NotSetOperator.NAME,new tuna.tmpl.units.condition.NotSetOperator),a.registerOperator(tuna.tmpl.units.condition.EqualsOperator.NAME,new tuna.tmpl.units.condition.EqualsOperator),a.registerOperator(tuna.tmpl.units.condition.NotEqualsOperator.NAME,new tuna.tmpl.units.condition.NotEqualsOperator),tuna.tmpl.__compiler.registerCompiler(tuna.tmpl.units.Condition.NAME,a)}return tuna.tmpl.__compiler},tuna.tmpl.__compiler=null,tuna.tmpl.getMarkupBuilder=function(){if(tuna.tmpl.__markupBuilder===null){tuna.tmpl.__markupBuilder=new tuna.tmpl.markup.MarkupTemplateBuilder,tuna.tmpl.__markupBuilder.addExtractor(new tuna.tmpl.markup.SpotExtractor),tuna.tmpl.__markupBuilder.addExtractor(new tuna.tmpl.markup.ListExtractor(tuna.tmpl.__markupBuilder)),tuna.tmpl.__markupBuilder.addExtractor(new tuna.tmpl.markup.AttributeExtractor),tuna.tmpl.__markupBuilder.addExtractor(new tuna.tmpl.markup.CheckboxExtractor);var a=new tuna.tmpl.markup.ConditionExtractor;a.addActionType(tuna.tmpl.units.condition.ClassAction.NAME),a.addOperatorType(tuna.tmpl.units.condition.IsSetOperator.NAME),a.addOperatorType(tuna.tmpl.units.condition.NotSetOperator.NAME),a.addOperatorType(tuna.tmpl.units.condition.EqualsOperator.NAME),a.addOperatorType(tuna.tmpl.units.condition.NotEqualsOperator.NAME),tuna.tmpl.__markupBuilder.addExtractor(a)}return tuna.tmpl.__markupBuilder},tuna.tmpl.__markupBuilder=null,tuna.tmpl.__settingsTable={},tuna.tmpl.getTemplateSettingsById=function(a){return tuna.tmpl.__settingsTable[a]===undefined&&(tuna.tmpl.__settingsTable[a]=tuna.tmpl.getMarkupBuilder().buildSettings(a)),tuna.tmpl.__settingsTable[a]},tuna.ui.Module=function(a){this._selector=a},tuna.ui.Module.prototype.init=function(a,b){var c=[],d=this._findTargets(a),e=0,f=d.length,g=null;while(e<f)this.__isInContext(d[e],a)&&(g=this.initInstance(d[e],b),g!==null&&(c.push(g),g.getBooleanOption("not-init")||g.init())),e++;return c},tuna.ui.Module.prototype._findTargets=function(a){var b=tuna.dom.select(this._selector,a);return b=b.concat(tuna.dom.matches(this._selector,[a])),b},tuna.ui.Module.prototype.__isInContext=function(a,b){var c=!0,d=tuna.ui.getIsolators(),e=0,f=d.length;while(e<f){if(a!==b){c=c&&!tuna.dom.hasClass(a,d[e])&&tuna.dom.getParentWithClass(a,d[e],b)===null;if(!c)break}e++}return c},tuna.ui.Module.prototype.destroy=function(a){var b=0,c=a.length;while(b<c)this.destroyInstance(a[b]),b++},tuna.ui.Module.prototype.initInstance=function(a,b){},tuna.ui.Module.prototype.destroyInstance=function(a){},tuna.ui.ModuleInstance=function(a){tuna.events.EventDispatcher.call(this),this._target=a,this.__defaultOptions={}},tuna.utils.extend(tuna.ui.ModuleInstance,tuna.events.EventDispatcher),tuna.ui.ModuleInstance.prototype.init=function(){},tuna.ui.ModuleInstance.prototype.destroy=function(){},tuna.ui.ModuleInstance.prototype.getTarget=function(){return this._target},tuna.ui.ModuleInstance.prototype.getName=function(){return this._target.getAttribute("data-name")},tuna.ui.ModuleInstance.prototype.setEnabled=function(a){tuna.dom.setClassExist(this._target,"disabled",!a)},tuna.ui.ModuleInstance.prototype.isEnabled=function(){return!tuna.dom.hasClass(this._target,"disabled")},tuna.ui.ModuleInstance.prototype._setDefaultOption=function(a,b){b===null?delete this.__defaultOptions[a]:this.__defaultOptions[a]=b},tuna.ui.ModuleInstance.prototype.setOption=function(a,b){b?this._target.setAttribute("data-"+a,b):this._target.removeAttribute("data-"+b)},tuna.ui.ModuleInstance.prototype.getOption=function(a){var b=this._target.getAttribute("data-"+a);return b===null&&this.__defaultOptions[a]!==undefined&&(b=this.__defaultOptions[a]),b},tuna.ui.ModuleInstance.prototype.getStringOption=function(a){var b=this._target.getAttribute("data-"+a);return b===null&&this.__defaultOptions[a]!==undefined&&(b=this.__defaultOptions[a]||""),b},tuna.ui.ModuleInstance.prototype.getNumberOption=function(a){var b=this._target.getAttribute("data-"+a);return b===null&&this.__defaultOptions[a]!==undefined&&(b=this.__defaultOptions[a]),b*1||0},tuna.ui.ModuleInstance.prototype.getBooleanOption=function(a){var b=this._target.getAttribute("data-"+a);return b===null&&this.__defaultOptions[a]!==undefined&&(b=this.__defaultOptions[a]),!!b},tuna.ui.ModuleInstance.prototype.getOptions=function(){return tuna.dom.getAttributesData(this._target)},tuna.ui.ModuleContainer=function(a){tuna.ui.ModuleInstance.call(this,a),this.__modules=[],this.__instances={}},tuna.utils.extend(tuna.ui.ModuleContainer,tuna.ui.ModuleInstance),tuna.ui.ModuleContainer.prototype.init=function(){this.initModules(this._target)},tuna.ui.ModuleContainer.prototype.destroy=function(){for(var a in this.__instances)this.__destroyModulesById(a)},tuna.ui.ModuleContainer.prototype.isActive=function(){return document.getElementById(this._target.id)===this._target},tuna.ui.ModuleContainer.prototype.requireModules=function(a){this.__modules=a},tuna.ui.ModuleContainer.prototype.initModules=function(a){a.id===null&&(a.id="container_"+tuna.ui.__lastId++);var b=a.id;this.__instances[b]===undefined&&(this.__instances[b]={});var c=this.__instances[b],d=0,e=this.__modules.length,f=null,g=null;while(d<e){f=this.__modules[d],g=tuna.ui.getModule(f);if(g===null)throw'Unknown module "'+f+'"';c[f]===undefined&&(c[f]=[]),c[f]=c[f].concat(g.init(a,this)),d++}},tuna.ui.ModuleContainer.prototype.destroyModules=function(a){this.__destroyModulesById(a.id)},tuna.ui.ModuleContainer.prototype.getModuleInstances=function(a,b){var c=[],d=null;if(b!==undefined)d=b.id,this.__instances[d]!==undefined&&this.__instances[d][a]!==undefined&&(c=this.__instances[d][a]);else for(d in this.__instances)this.__instances[d][a]!==undefined&&(c=c.concat(this.__instances[d][a]));return c},tuna.ui.ModuleContainer.prototype.getModuleInstanceByName=function(a,b){for(var c in this.__instances)if(this.__instances[c][a]!==undefined){var d=this.__instances[c][a],e=0,f=d.length;while(e<f){if(d[e].getName()===b)return d[e];e++}}return null},tuna.ui.ModuleContainer.prototype.__destroyModulesById=function(a){var b=null;for(var c in this.__instances[a])b=tuna.ui.getModule(c),b!==null&&b.destroy(this.__instances[a][c]),this.__instances[a][c].length=0;delete this.__instances[a]},tuna.ui.__lastId=0,tuna.ui.__typeTable={},tuna.ui.__isolators=[],tuna.ui.registerModule=function(a,b){tuna.ui.__typeTable[a]=b},tuna.ui.getModule=function(a){return tuna.ui.__typeTable[a]!==undefined?tuna.ui.__typeTable[a]:null},tuna.ui.getIsolators=function(){return tuna.ui.__isolators},tuna.ui.addIsolator=function(a){tuna.utils.indexOf(a,tuna.ui.__isolators)===-1&&tuna.ui.__isolators.push(a)},tuna.ui.popups.Popup=function(a){tuna.ui.ModuleInstance.call(this,a),this.__isInit=!1},tuna.utils.extend(tuna.ui.popups.Popup,tuna.ui.ModuleInstance),tuna.ui.popups.Popup.prototype.init=function(){if(!this.__isInit){var a=this;tuna.dom.addChildEventListener(this._target,".j-popup-close","click",function(b){tuna.dom.preventDefault(b),a.close()}),tuna.dom.addChildEventListener(this._target,".j-popup-apply","click",function(b){tuna.dom.preventDefault(b),a.apply()})}},tuna.ui.popups.Popup.prototype.isOpen=function(){return tuna.dom.hasClass(this._target,"show")},tuna.ui.popups.Popup.prototype.open=function(){this.dispatch("open")&&this.__show()},tuna.ui.popups.Popup.prototype.close=function(){this.dispatch("close")&&this.__hide()},tuna.ui.popups.Popup.prototype.apply=function(){this.dispatch("apply",this.__collectData())&&this.__hide()},tuna.ui.popups.Popup.prototype.__hide=function(){tuna.dom.removeClass(this._target,"show")},tuna.ui.popups.Popup.prototype.__show=function(){tuna.dom.addClass(this._target,"show")},tuna.ui.popups.Popup.prototype.__collectData=function(){var a=tuna.dom.selectOne("form.j-popup-form",this._target);return a!==null?tuna.ui.forms.serialize(a):null},tuna.ui.popups.__idTable={},tuna.ui.popups.__lastId=0,tuna.ui.popups.create=function(a){a.id===""&&(a.id="popup_"+tuna.ui.popups.__lastId++);if(tuna.ui.popups.__idTable[a.id]===undefined){var b=new tuna.ui.popups.Popup(a);b.init(),tuna.ui.popups.__idTable[a.id]=b}return tuna.ui.popups.__idTable[a.id]},tuna.ui.popups.__alert=null,tuna.ui.popups.__alertMessage=null,tuna.ui.popups.registerAlert=function(a){a!==null?(tuna.ui.popups.__alert=tuna.ui.popups.create(a),tuna.ui.popups.__alert.init(),tuna.ui.popups.__alertMessage=tuna.dom.selectOne(".j-message",a)):tuna.ui.popups.__alert!==null&&(tuna.ui.popups.__alert.destroy(),tuna.ui.popups.__alert=null,tuna.ui.popups.__alertMessage=null)},tuna.ui.popups.alert=function(a){tuna.ui.popups.__alert!==null&&tuna.ui.popups.__alertMessage!==null&&(tuna.ui.popups.__alertMessage.innerHTML=a,tuna.ui.popups.__alert.open())},tuna.ui.popups.__confirm=null,tuna.ui.popups.__confirmMessage=null,tuna.ui.popups.registerConfirm=function(a){a!==null?(tuna.ui.popups.__confirm=tuna.ui.popups.create(a),tuna.ui.popups.__confirm.init(),tuna.ui.popups.__confirmMessage=tuna.dom.selectOne(".j-message",a)):tuna.ui.popups.__confirm!==null&&(tuna.ui.popups.__confirm.destroy(),tuna.ui.popups.__confirm=null,tuna.ui.popups.__confirmMessage=null)},tuna.ui.popups.confirm=function(a,b){tuna.ui.popups.__confirmMessage.innerHTML=a;var c=function(a){b(a.getType()==="apply"),tuna.ui.popups.__confirm.removeEventListener("apply",c),tuna.ui.popups.__confirm.removeEventListener("close",c)};tuna.ui.popups.__confirm.addEventListener("apply",c),tuna.ui.popups.__confirm.addEventListener("close",c),tuna.ui.popups.__confirm.open()},tuna.ui.buttons.Button=function(a){tuna.ui.ModuleInstance.call(this,a),this._isInit=!1},tuna.utils.extend(tuna.ui.buttons.Button,tuna.ui.ModuleInstance),tuna.ui.buttons.Button.prototype.init=function(){if(!this._isInit){this._isInit=!0;var a=this;tuna.dom.addEventListener(this._target,"click",function(b){a.isEnabled()?a.dispatch("click"):tuna.dom.stopPropagation(b)})}},tuna.ui.buttons.Button.prototype.setActive=function(a){tuna.dom.setClassExist(this._target,"active",a)},tuna.ui.buttons.PopupButton=function(a){tuna.ui.buttons.Button.call(this,a),this._popup=null},tuna.utils.extend(tuna.ui.buttons.PopupButton,tuna.ui.buttons.Button),tuna.ui.buttons.PopupButton.prototype.init=function(){var a=this.getOption("popup-id");if(a!==null){var b=tuna.dom.selectOne("#"+a);b!==null&&(this._popup=tuna.ui.popups.create(b))}var c=this;tuna.dom.addEventListener(this._target,"click",function(a){c.isEnabled()?c.dispatch("click")&&c._popup!==null&&c._popup.open():tuna.dom.stopPropagation(a)})},tuna.ui.buttons.PopupButton.prototype.getPopup=function(){return this._popup},tuna.ui.buttons.ButtonGroup=function(a){tuna.ui.ModuleInstance.call(this,a),this.__defaultAction=null,this.__isPreventDefault=!0,this._setDefaultOption("button-selector",".j-button")},tuna.utils.extend(tuna.ui.buttons.ButtonGroup,tuna.ui.ModuleInstance),tuna.ui.buttons.ButtonGroup.prototype.setDefaultAction=function(a){this.__defaultAction=a},tuna.ui.buttons.ButtonGroup.prototype.setPreventDefault=function(a){this.__isPreventDefault=a},tuna.ui.buttons.ButtonGroup.prototype.init=function(){var a=this,b=this.getStringOption("button-selector");b!==null&&tuna.dom.addChildEventListener(this._target,b,"click",function(b){a.__isPreventDefault&&tuna.dom.preventDefault(b);var c=tuna.ui.buttons.create(this),d=c.getStringOption("action");d===null&&(d=a.__defaultAction),d!==null&&(a.dispatch(d,c)||tuna.dom.stopPropagation(b))})},tuna.ui.buttons.__idTable={},tuna.ui.buttons.__lastId=0,tuna.ui.buttons.create=function(a){a.id===""&&(a.id="button_"+tuna.ui.buttons.__lastId++);if(tuna.ui.buttons.__idTable[a.id]===undefined){var b=new tuna.ui.buttons.Button(a);b.init(),tuna.ui.buttons.__idTable[a.id]=b}return tuna.ui.buttons.__idTable[a.id]},tuna.ui.flash.SWF=function(a){tuna.ui.ModuleInstance.call(this,a),this.__movieId=null,this.__movie=null,this._setDefaultOption("wmode","opaque"),this._setDefaultOption("menu",!1),this._setDefaultOption("allow-fullscreen",!1),this._setDefaultOption("allow-script-access","always")},tuna.utils.extend(tuna.ui.flash.SWF,tuna.ui.ModuleInstance),tuna.ui.flash.SWF.prototype.init=function(){this.__movieId="swf_"+tuna.ui.flash.__lastId++,this._target.innerHTML='<div id="'+this.__movieId+'"></div>';var a=null,b=this.getStringOption("flashvars");b!==null&&(a=tuna.utils.urlDecode(b));var c=this.getStringOption("src"),d=this.getStringOption("width"),e=this.getStringOption("height");c!==null&&d!==null&&e!==null&&swfobject.embedSWF(c,this.__movieId,d,e,"10.0.0",null,a,{wmode:this.getStringOption("wmode"),allowfullscreen:this.getStringOption("allow-fullscreen"),allowscriptaccess:this.getStringOption("allow-script-access"),menu:this.getStringOption("menu")})},tuna.ui.flash.SWF.prototype.destroy=function(){this._target.innerHTML="",this.__movieId=null,this.__movie=null},tuna.ui.flash.SWF.prototype.reset=function(){this.destroy(),this.init()},tuna.ui.flash.SWF.prototype.getMovie=function(){return this.__movieId!==null&&this.__movie===null&&(this.__movie=swfobject.getObjectById(this.__movieId)),this.__movie},tuna.ui.flash.__lastId=0,tuna.ui.forms.Form=function(a){tuna.ui.ModuleInstance.call(this,a),this.__formMessage=null,this.__inputTable={},this.__recordName=null},tuna.utils.extend(tuna.ui.forms.Form,tuna.ui.ModuleInstance),tuna.ui.forms.Form.prototype.init=function(){this.__recordName=this.getStringOption("record-type"),this.__formMessage=tuna.dom.selectOne(".j-form-message",this._target);var a=document.createElement("input");a.type="hidden",a.name="__callback",this._target.appendChild(a);var b=this;tuna.dom.addEventListener(this._target,"submit",function(c){b.isEnabled()?(a.value="form_callback"+(Math.random()+"").substr(2),window[a.value]=function(c){b.__handleResponse(tuna.utils.clone(c)),window[a.value]=undefined},b.__prepareTo(c.type,c)):tuna.dom.preventDefault(c)}),tuna.dom.addEventListener(this._target,"reset",function(a){b.isEnabled()?b.__prepareTo(a.type,a):tuna.dom.preventDefault(a)})},tuna.ui.forms.Form.prototype.getValue=function(a){var b=null,c=this._target.elements[a];if(c!==undefined){var d=!1;if(c.value===undefined){var e=0,f=c.length;b=[];while(e<f)d=c[e].type==="checkbox"||c[e].type==="radio",(!d||d&&c[e].checked)&&b.push(c[e].value),e++}else{d=c.type==="checkbox"||c.type==="radio";if(!d||d&&c.checked)b=c.value}}return b},tuna.ui.forms.Form.prototype.setValue=function(a,b){var c=this._target.elements[a];if(c!==undefined)if(c.value===undefined){var d=0,e=c.length,f="",g=[];b instanceof Array?(g=tuna.utils.cloneArray(b),f=b.join(",")):(f=b+"",g=[f]);var h=-1;while(d<e)c[d].type==="radio"?c[d].checked=c[d].value===f:c[d].type==="checkbox"?(h=tuna.utils.indexOf(c[d].value,g),c[d].checked=h!==-1,h!==-1&&g.splice(h,1)):c.value=f,d++}else c.type==="checkbox"||c.type==="radio"?c.checked=c.value===b:c.value=b},tuna.ui.forms.Form.prototype.setInputEnabled=function(a,b){var c=this._target.elements[a];if(c!==undefined)if(c.value===undefined){var d=0,e=c.length;while(d<e)b?c[d].removeAttribute("disabled"):c[d].setAttribute("disabled",!0),d++}else b?c.removeAttribute("disabled"):c.setAttribute("disabled",!0)},tuna.ui.forms.Form.prototype.submit=function(){this.__prepareTo("submit"),this._target.submit()},tuna.ui.forms.Form.prototype.reset=function(){this.__prepareTo("reset"),this._target.reset()},tuna.ui.forms.Form.prototype.serialize=function(){return tuna.ui.forms.serialize(this._target)},tuna.ui.forms.Form.prototype.__prepareTo=function(a,b){this.dispatch(a)?(this.__clearMessage(),this.__clearInputs()):b!==undefined&&tuna.dom.preventDefault(b)},tuna.ui.forms.Form.prototype.__handleResponse=function(a){var b=a.response,c=a.errors;b!==undefined?(this.__recordName!==null&&(b=tuna.rest.populateRecords(b,this.__recordName)),this.dispatch("result",b)):c!==undefined&&(this.__showErrors(c),this.dispatch("error",c))},tuna.ui.forms.Form.prototype.__showErrors=function(a){var b=0,c=a.length,d=null;while(b<c)d=a[b],d.param!==undefined?this.__showInputError(d.param,d.message):this.__showErrorMessage(d.message),b++},tuna.ui.forms.Form.prototype.__getFormInput=function(a){var b=null;if(this.__inputTable[a]===undefined){var c=tuna.dom.selectOne(".j-"+a+"-input",this._target);if(c!==null){var d=new tuna.ui.forms.FormInput(c);d.init(),this.__inputTable[a]=d}}return this.__inputTable[a]!==undefined&&(b=this.__inputTable[a]),b},tuna.ui.forms.Form.prototype.__clearMessage=function(){this.__formMessage!==null&&(this.__formMessage.innerHTML="",tuna.dom.addClass(this.__formMessage,"hide"))},tuna.ui.forms.Form.prototype.__showErrorMessage=function(a){this.__formMessage!==null&&(this.__formMessage.innerHTML+=a+"<br />",tuna.dom.removeClass(this.__formMessage,"hide"))},tuna.ui.forms.Form.prototype.__showInputError=function(a,b){var c=this.__getFormInput(a);c!==null?c.showErrorMessage(b):this.__showErrorMessage(b)},tuna.ui.forms.Form.prototype.__clearInputs=function(){for(var a in this.__inputTable)this.__inputTable[a].cleanup()},tuna.ui.forms.FormInput=function(a){tuna.ui.ModuleInstance.call(this,a),this.__message=null,this.__defaultMessage=""},tuna.utils.extend(tuna.ui.forms.FormInput,tuna.ui.ModuleInstance),tuna.ui.forms.FormInput.prototype.init=function(){this.__message=tuna.dom.selectOne(".j-message",this._target),this.__message!==null&&(this.__defaultMessage=this.__message.innerHTML)},tuna.ui.forms.FormInput.prototype.showErrorMessage=function(a){tuna.dom.addClass(this._target,"error"),this.__message!==null&&(this.__message.innerHTML=a)},tuna.ui.forms.FormInput.prototype.cleanup=function(){tuna.dom.removeClass(this._target,"error"),this.__message!==null&&(this.__message.innerHTML=this.__defaultMessage)},tuna.ui.forms.InputFilter=function(a){tuna.ui.ModuleInstance.call(this,a),this._data=null,this._currentData=null,this._input=null,this._itemSerializeCallback=function(a){return a.name!==undefined?""+a.name:""},this._transformer=new tuna.ui.transformers.TemplateTransformer(a)},tuna.utils.extend(tuna.ui.forms.InputFilter,tuna.ui.ModuleInstance),tuna.ui.forms.InputFilter.prototype.init=function(){this._input=tuna.dom.selectOne("input.j-filtration",this._target);if(this._input!==null){var a=this,b=null;tuna.dom.addEventListener(this._input,"keyup",function(){this.value!==b&&(a.filter(this.value),b=this.value)})}this._transformer.init()},tuna.ui.forms.InputFilter.prototype.setItemSerializeCallback=function(a){this._itemSerializeCallback=a},tuna.ui.forms.InputFilter.prototype.setData=function(a){this._currentData=this._data=a,this.update()},tuna.ui.forms.InputFilter.prototype.filter=function(a){this._currentData=this._filterData(a),this.update()},tuna.ui.forms.InputFilter.prototype.update=function(){this._transformer.applyTransform(this._currentData)},tuna.ui.forms.InputFilter.prototype.clear=function(){this._input.value="",this.filter("")},tuna.ui.forms.InputFilter.prototype._filterData=function(a){var b=[];if(!a||a.length===0)b=tuna.utils.cloneArray(this._data);else{var c=a.toUpperCase(),d=0,e=this._data.length,f=null;while(d<e)f=this._itemSerializeCallback(this._data[d]),f.toUpperCase().indexOf(c)!==-1&&b.push(this._data[d]),d++}return b},tuna.ui.forms.Autocomplete=function(a){tuna.ui.forms.InputFilter.call(this,a),this.__listBody=null,this.__selectedData=null,this.__selectionGroup=new tuna.ui.selection.SelectionGroup(a,null)},tuna.utils.extend(tuna.ui.forms.Autocomplete,tuna.ui.forms.InputFilter),tuna.ui.forms.Autocomplete.prototype.init=function(){tuna.ui.forms.InputFilter.prototype.init.call(this);var a=this;this.__listBody=tuna.dom.selectOne(".j-autocomplete-body",this._target);if(this.__listBody!==null&&this._input!==null){var b=!1;tuna.dom.addEventListener(this._input,"focus",function(){b||(document.body!==null&&tuna.dom.addOneEventListener(document.body,"click",function(){a.selectValue(a._input.value),a.getSelectedData()===null&&a.clear(),tuna.dom.addClass(a.__listBody,"hide"),b=!1}),a.filter(""),tuna.dom.removeClass(a.__listBody,"hide"),b=!0)}),tuna.dom.addChildEventListener(this._target,".j-autocomplete-item","click",function(b){var c=a.__selectionGroup.getItemIndex(this);c!==null?a.selectIndex(c):tuna.dom.stopPropagation(b)}),tuna.dom.addEventListener(this._input,"click",function(a){tuna.dom.stopPropagation(a)}),this.__selectionGroup.setOption("item-selector",".j-autocomplete-item"),this.__selectionGroup.init()}},tuna.ui.forms.Autocomplete.prototype.getSelectedData=function(){return this.__selectedData},tuna.ui.forms.Autocomplete.prototype.selectValue=function(a){this.__selectedData=null;var b=this._filterData(a),c=b.shift();c!==undefined&&this._itemSerializeCallback(c)===a&&this.__selectData(c)},tuna.ui.forms.Autocomplete.prototype.selectIndex=function(a){this._currentData.length>0&&this.__selectData(this._currentData[a])},tuna.ui.forms.Autocomplete.prototype.__selectData=function(a){this.__selectedData!==a&&(this.__selectedData=a,this._input.value=this._itemSerializeCallback(a),this.dispatch("change"))},tuna.ui.forms.Autocomplete.prototype.clearSelection=function(){this.__selectedData!==null&&(this.__selectedData=null,this.dispatch("change"))},tuna.ui.forms.Autocomplete.prototype.update=function(){tuna.ui.forms.InputFilter.prototype.update.call(this),this.__selectionGroup.updateView(),this.clearSelection()},tuna.ui.forms.serialize=function(a){var b={},c=a.elements,d=0,e=c.length,f=null;while(d<e)f=c[d].name,b[f]!==undefined?(b[f]instanceof Array||(b[f]=[b[f]]),b[f].push(c[d].value)):b[f]=c[d].value,d++;return b},tuna.ui.transformers.ITransformHandler=function(){},tuna.ui.transformers.ITransformHandler.prototype.handleTransformStart=function(a){},tuna.ui.transformers.ITransformHandler.prototype.handleTransformComplete=function(a,b,c){},tuna.ui.transformers.ITransformer=function(){},tuna.ui.transformers.ITransformer.prototype.applyTransform=function(a){},tuna.ui.transformers.ITransformer.prototype.setTransformHandler=function(a){},tuna.ui.transformers.TemplateTransformer=function(a){tuna.ui.ModuleInstance.call(this,a),this.__template=null,this.__transformHandler=null},tuna.utils.extend(tuna.ui.transformers.TemplateTransformer,tuna.ui.ModuleInstance),tuna.ui.transformers.TemplateTransformer.prototype.init=function(){var a=this.getStringOption("template-id");if(a!==null){var b=tuna.tmpl.getTemplateSettingsById(a);if(b===null)throw'Unknown template with id "'+a+'"';this.__template=tuna.tmpl.compile(this._target,b)}},tuna.ui.transformers.TemplateTransformer.prototype.setTransformHandler=function(a){this.__transformHandler=a},tuna.ui.transformers.TemplateTransformer.prototype.applyTransform=function(a){this.__transformHandler!==null&&this.__transformHandler.handleTransformStart(this),this.__template.applyData(new tuna.tmpl.data.DataNode(a)),this.__transformHandler!==null&&this.__transformHandler.handleTransformComplete(this,this.__template.fetchCreatedChildren(),this.__template.fetchRemovedChildren())},tuna.ui.transformers.TemplateTransformer.prototype.destroy=function(){this.__template.destroy(),this.__template=null,this.__transformHandler=null},tuna.ui.transformers.TemplateTransformer.prototype.reset=function(){var a=this.__transformHandler;this.destroy(),this.init(),this.__transformHandler=a},tuna.ui.selection.ISelectionGroup=function(){},tuna.ui.selection.ISelectionGroup.prototype.getSelectedIndexes=function(){},tuna.ui.selection.ISelectionGroup.prototype.selectIndex=function(a){},tuna.ui.selection.ISelectionGroup.prototype.isSelected=function(a){},tuna.ui.selection.ISelectionGroup.prototype.clearSelection=function(){},tuna.ui.selection.ISelectionGroup.prototype.setIndexEnabled=function(a,b){},tuna.ui.selection.ISelectionGroup.prototype.isIndexEnabled=function(a){},tuna.ui.selection.ISelectionGroup.prototype.getItemIndex=function(a){},tuna.ui.selection.ISelectionGroup.prototype.getItemAt=function(a){},tuna.ui.selection.ISelectionGroup.prototype.mapItems=function(a){},tuna.ui.selection.ISelectionGroup.prototype.updateView=function(){},tuna.ui.selection.AbstractSelectionGroup=function(a){tuna.ui.ModuleInstance.call(this,a),this._itemsCollection=null,this._selectionView=null,this._selectionRule=null},tuna.utils.extend(tuna.ui.selection.AbstractSelectionGroup,tuna.ui.ModuleInstance),tuna.ui.selection.AbstractSelectionGroup.prototype.setIndexEnabled=function(a,b){this._selectionRule.setIndexEnabled(a,b)},tuna.ui.selection.AbstractSelectionGroup.prototype.isIndexEnabled=function(a){return this._selectionRule.isIndexEnabled(a)},tuna.ui.selection.AbstractSelectionGroup.prototype.updateView=function(){this._selectionView.update()},tuna.ui.selection.AbstractSelectionGroup.prototype.getItemIndex=function(a){return this._itemsCollection.getItemIndex(a)},tuna.ui.selection.AbstractSelectionGroup.prototype.getItemAt=function(a){return this._itemsCollection.getItemAt(a)},tuna.ui.selection.AbstractSelectionGroup.prototype.mapItems=function(a){this._itemsCollection.mapItems(a)},tuna.ui.selection.AbstractSelectionGroup.prototype.getSelectedIndexes=function(){return this._selectionRule.getSelectedIndexes()},tuna.ui.selection.AbstractSelectionGroup.prototype.getLastSelectedIndex=function(){var a=this._selectionRule.getSelectedIndexes();return a.length>0?a.pop():null},tuna.ui.selection.AbstractSelectionGroup.prototype.selectIndex=function(a){return this._selectionRule.selectIndex(a)},tuna.ui.selection.AbstractSelectionGroup.prototype.isSelected=function(a){return this._selectionRule.isSelected(a)},tuna.ui.selection.AbstractSelectionGroup.prototype.clearSelection=function(){this._selectionRule.clearSelection()},tuna.ui.selection.SelectionGroup=function(a,b){tuna.ui.selection.AbstractSelectionGroup.call(this,a),this._defaultOptions={"selection-class":".active","item-selector":".j-navigation-page","menu-selector":".j-navigation-menu"},this._setDefaultOption("item-selector",".j-selection-item"),this._setDefaultOption("index-attribute",b),this._setDefaultOption("is-multiple",null),this._setDefaultOption("selection-class","active"),this._setDefaultOption("selection-event","click")},tuna.utils.extend(tuna.ui.selection.SelectionGroup,tuna.ui.selection.AbstractSelectionGroup),tuna.ui.selection.SelectionGroup.prototype.init=function(){var a=this.getStringOption("index-attribute");this._itemsCollection=a===null?new tuna.ui.selection.items.ElementsCollection:new tuna.ui.selection.items.NamedElementsCollection(a),this._selectionView=new tuna.ui.selection.view.ClassSelectionView(this._target),this._selectionRule=this._createSelectionRule(),this._selectionView.setSelectionClass(this.getStringOption("selection-class")),this._selectionView.setItemSelector(this.getStringOption("item-selector")),this._selectionView.setSelectionRule(this._selectionRule),this._selectionView.setItemsCollection(this._itemsCollection),this._selectionRule.setEventDispatcher(this),this._selectionRule.setItemsCollection(this._itemsCollection),this._selectionRule.setSelectionView(this._selectionView),this._selectionView.update()},tuna.ui.selection.SelectionGroup.prototype._createSelectionRule=function(){return this.getBooleanOption("is-multiple")?new tuna.ui.selection.rule.MultipleSelectionRule:new tuna.ui.selection.rule.SingleSelectionRule},tuna.ui.selection.Navigation=function(a){tuna.ui.ModuleInstance.call(this,a),this.__navigationRule=null,this.__menuLinks={},this.__parent=null,this.__children={},this.__history=[],this.__currentState=null,this._setDefaultOption("selection-class","active"),this._setDefaultOption("item-selector",".j-navigation-page"),this._setDefaultOption("menu-selector",".j-navigation-menu")},tuna.utils.extend(tuna.ui.selection.Navigation,tuna.ui.ModuleInstance),tuna.ui.selection.Navigation.prototype.init=function(){this.__initNavigation(),this.__initControls(),this.__initMenu()},tuna.ui.selection.Navigation.prototype.__initNavigation=function(){this.__navigationRule=new tuna.ui.selection.rule.NavigationSelectionRule;var a=new tuna.ui.selection.items.NamedElementsCollection("data-name"),b=new tuna.ui.selection.view.ClassSelectionView(this._target);b.setSelectionClass(this.getStringOption("selection-class")),b.setItemSelector(this.getStringOption("item-selector")),b.setSelectionRule(this.__navigationRule),b.setItemsCollection(a),this.__navigationRule.setEventDispatcher(this),this.__navigationRule.setSelectionView(b),this.__navigationRule.setItemsCollection(a),this.__navigationRule.setNavigation(this),b.update()},tuna.ui.selection.Navigation.prototype.__initControls=function(){var a=this,b=new tuna.ui.buttons.ButtonGroup(this._target);b.setOption("button-selector",".j-navigation-link"),b.setDefaultAction("navigate"),b.addEventListener("navigate",function(b,c){b.preventDefault();var d=c.getStringOption("href");if(d!==null){var e=c.getOptions();delete e.href,a.navigate(d,e)}}),b.addEventListener("back",function(b,c){b.preventDefault(),a.back()}),b.init()},tuna.ui.selection.Navigation.prototype.__initMenu=function(){var a=this.getStringOption("menu-selector"),b=this.getStringOption("button-selector");if(a!==null&&b!==null){var c=tuna.dom.selectOne(a,this._target);if(c!==null){var d=tuna.dom.select(b,c),e=0,f=d.length,g=null,h=null,i=null;while(e<f)i=tuna.ui.buttons.create(d[e]),g=i.getStringOption("href"),g!==null&&(h=g.split("/").shift(),this.__menuLinks[h]===undefined&&(this.__menuLinks[h]=[]),this.__menuLinks[h].push(i)),e++}}var j=this.__navigationRule.getCurrentIndex();j!==null&&this.__updateMenu(j,!0)},tuna.ui.selection.Navigation.prototype.__updateMenu=function(a,b){if(a!==null){var c=this.__menuLinks[a];if(c!==undefined){var d=0,e=c.length;while(d<e)c[d].setActive(b),d++}}},tuna.ui.selection.Navigation.prototype.getCurrentController=function(){return this.__navigationRule.getCurrentController()},tuna.ui.selection.Navigation.prototype.getPathDesc=function(){var a=[],b=this.__navigationRule.getCurrentIndex();return b!==null&&(a.push(b),this.__children[b]!==undefined&&(a=a.concat(this.__children[b].getPathDesc()))),a},tuna.ui.selection.Navigation.prototype.getRelatedPath=function(){var a=[];return this.__parent!==null&&(a.push(this.getName()),a=this.__parent.getRelatedPath().concat(a)),a},tuna.ui.selection.Navigation.prototype.getRoot=function(){return this.isRoot()?this:this.__parent.getRoot()},tuna.ui.selection.Navigation.prototype.isRoot=function(){return this.__parent===null},tuna.ui.selection.Navigation.prototype.back=function(){this.isRoot()?this.__history.length>0&&(this.__currentState=this.__history.pop(),this.navigatePath(this.__currentState.getPath(),this.__currentState.getData())):this.getRoot().back()},tuna.ui.selection.Navigation.prototype.navigate=function(a,b){if(a instanceof Array)this.isRoot()?(this.__currentState===null&&(this.__currentState=new NavigationState(this.getPathDesc())),this.navigatePath(a,b),this.__history.push(this.__currentState),this.__currentState=new NavigationState(this.getPathDesc(),b)):this.navigatePath(a,b);else{var c=a.split("/");a.indexOf("/")!==0&&(c=this.getRelatedPath().concat(c)),this.getRoot().navigate(c,b)}},tuna.ui.selection.Navigation.prototype.navigatePath=function(a,b){var c=a.shift();while(c===""&&a.length>0)c=a.shift();this.__updateMenu(this.__navigationRule.getCurrentIndex(),!1),this.__navigationRule.navigate(c,b||null),this.__updateMenu(this.__navigationRule.getCurrentIndex(),!0);if(this.__children[c]!==undefined)return this.__children[c].navigatePath(a,b)},tuna.ui.selection.Navigation.prototype.addChild=function(a){if(a instanceof tuna.ui.selection.Navigation){a.setParent(this);var b=a.getName();b!==null&&(this.__children[b]=a)}},tuna.ui.selection.Navigation.prototype.setParent=function(a){this.__parent=a};var NavigationState=function(a,b){this.__path=a,this.__data=b||null};NavigationState.prototype.serialize=function(){var a="";return this.__data!==null&&(a=tuna.utils.urlEncode(this.__data)),a!==""&&(a="?"+a),"/"+this.__path.join("/")+a},NavigationState.prototype.getPath=function(){return tuna.utils.cloneArray(this.__path)},NavigationState.prototype.getData=function(){return this.__data},tuna.ui.selection.Carousel=function(a){tuna.ui.selection.SelectionGroup.call(this,a,null),this.__shiftIndex=-1,this._setDefaultOption("item-selector",".j-carousel-item"),this._setDefaultOption("next-button-selector",".j-carousel-next"),this._setDefaultOption("back-button-selector",".j-carousel-back")},tuna.utils.extend(tuna.ui.selection.Carousel,tuna.ui.selection.SelectionGroup),tuna.ui.selection.Carousel.prototype.init=function(){tuna.ui.selection.SelectionGroup.prototype.init.call(this);var a=this;this.__shiftIndex=Number(this.getLastSelectedIndex());var b=this.getStringOption("next-button-selector");b!==null&&tuna.dom.addChildEventListener(this._target,b,"click",function(b){tuna.dom.preventDefault(b),a.next()});var c=this.getStringOption("back-button-selector");c!==null&&tuna.dom.addChildEventListener(this._target,c,"click",function(b){tuna.dom.preventDefault(b),a.back()})},tuna.ui.selection.Carousel.prototype.next=function(){this.__shiftIndex++,this.getItemAt(this.__shiftIndex)===null&&(this.__shiftIndex=0),this.selectIndex(this.__shiftIndex)},tuna.ui.selection.Carousel.prototype.back=function(){this.__shiftIndex--,this.getItemAt(this.__shiftIndex)===null&&(this.__shiftIndex=this._itemsCollection.getItemsCount()-1),this.selectIndex(this.__shiftIndex)},tuna.ui.selection.items.IItemsCollection=function(){},tuna.ui.selection.items.IItemsCollection.prototype.addItem=function(a){},tuna.ui.selection.items.IItemsCollection.prototype.getItemIndex=function(a){},tuna.ui.selection.items.IItemsCollection.prototype.getItemAt=function(a){},tuna.ui.selection.items.IItemsCollection.prototype.mapItems=function(a){},tuna.ui.selection.items.IItemsCollection.prototype.clear=function(){},tuna.ui.selection.items.IItemsCollection.prototype.getItemsCount=function(){},tuna.ui.selection.items.ElementsCollection=function(){this.__items=[]},tuna.ui.selection.items.ElementsCollection.prototype.addItem=function(a){return this.__items.push(a)-1},tuna.ui.selection.items.ElementsCollection.prototype.getItemIndex=function(a){return tuna.utils.indexOf(a,this.__items)},tuna.ui.selection.items.ElementsCollection.prototype.getItemAt=function(a){return this.__items[a]||null},tuna.ui.selection.items.ElementsCollection.prototype.clear=function(){this.__items.length=0},tuna.ui.selection.items.ElementsCollection.prototype.mapItems=function(a){var b=0,c=this.__items.length;while(b<c)a(b,this.__items[b]),b++},tuna.ui.selection.items.ElementsCollection.prototype.getItemsCount=function(){return this.__items.length},tuna.ui.selection.items.NamedElementsCollection=function(a){this.__indexAttribute=a,this.__items={}},tuna.ui.selection.items.NamedElementsCollection.prototype.addItem=function(a){var b=a.getAttribute(this.__indexAttribute);return b!==null&&(this.__items[b]=a),b},tuna.ui.selection.items.NamedElementsCollection.prototype.getItemIndex=function(a){var b=a.getAttribute(this.__indexAttribute);return b!==null&&this.__items[b]!==undefined?b:null},tuna.ui.selection.items.NamedElementsCollection.prototype.getItemAt=function(a){return this.__items[a]||null},tuna.ui.selection.items.NamedElementsCollection.prototype.clear=function(){this.__items={}},tuna.ui.selection.items.NamedElementsCollection.prototype.mapItems=function(a){for(var b in this.__items)a(b,this.__items[b])},tuna.ui.selection.items.NamedElementsCollection.prototype.getItemsCount=function(){var a=0;for(var b in this.__items)a++;return a},tuna.ui.selection.rule.ISelectionRule=function(){},tuna.ui.selection.rule.ISelectionRule.prototype.getSelectedIndexes=function(){},tuna.ui.selection.rule.ISelectionRule.prototype.selectIndex=function(a){},tuna.ui.selection.rule.ISelectionRule.prototype.isSelected=function(a){},tuna.ui.selection.rule.ISelectionRule.prototype.clearSelection=function(){},tuna.ui.selection.rule.ISelectionRule.prototype.setIndexEnabled=function(a,b){},tuna.ui.selection.rule.ISelectionRule.prototype.isIndexEnabled=function(a){},tuna.ui.selection.rule.AbstractSelectionRule=function(){this._itemsCollection=null,this._selectionView=null,this._eventDispatcher=null,this._disabledIndexes=[]},tuna.ui.selection.rule.AbstractSelectionRule.prototype.setItemsCollection=function(a){this._itemsCollection=a},tuna.ui.selection.rule.AbstractSelectionRule.prototype.setSelectionView=function(a){this._selectionView=a},tuna.ui.selection.rule.AbstractSelectionRule.prototype.setEventDispatcher=function(a){this._eventDispatcher=a},tuna.ui.selection.rule.AbstractSelectionRule.prototype.getSelectedIndexes=function(){},tuna.ui.selection.rule.AbstractSelectionRule.prototype.selectIndex=function(a){},tuna.ui.selection.rule.AbstractSelectionRule.prototype.isSelected=function(a){},tuna.ui.selection.rule.AbstractSelectionRule.prototype.clearSelection=function(){},tuna.ui.selection.rule.AbstractSelectionRule.prototype.setIndexEnabled=function(a,b){var c=tuna.utils.indexOf(a,this._disabledIndexes);b?c!==-1&&(this._selectionView.enableItemAt(a),this._disabledIndexes.splice(c,1)):c===-1&&(this._selectionView.disableItemAt(a),this._disabledIndexes.push(a))},tuna.ui.selection.rule.AbstractSelectionRule.prototype.isIndexEnabled=function(a){return this._itemsCollection.getItemAt(a)!==null&&tuna.utils.indexOf(a,this._disabledIndexes)===-1},tuna.ui.selection.rule.SingleSelectionRule=function(){tuna.ui.selection.rule.AbstractSelectionRule.call(this),this.__currentIndex=null},tuna.utils.extend(tuna.ui.selection.rule.SingleSelectionRule,tuna.ui.selection.rule.AbstractSelectionRule),tuna.ui.selection.rule.SingleSelectionRule.prototype.getSelectedIndexes=function(){return this.__currentIndex!==null?[this.__currentIndex]:[]},tuna.ui.selection.rule.SingleSelectionRule.prototype.selectIndex=function(a){if(this.isIndexEnabled(a)&&this.__currentIndex!==a&&this.__dispatchSelect(a)){var b=this.__currentIndex;return this.__currentIndex!==null&&this._selectionView.destroySelectionAt(this.__currentIndex),this._selectionView.applySelectionAt(a),this.__currentIndex=a,b!==null&&this._eventDispatcher.dispatch("deselected",b),this._eventDispatcher.dispatch("selected",a),!0}return!1},tuna.ui.selection.rule.SingleSelectionRule.prototype.__dispatchSelect=function(a){var b=this.__currentIndex;return(b===null||this._eventDispatcher.dispatch("deselect",b))&&this._eventDispatcher.dispatch("select",a)},tuna.ui.selection.rule.SingleSelectionRule.prototype.isSelected=function(a){return a===this.__currentIndex},tuna.ui.selection.rule.SingleSelectionRule.prototype.clearSelection=function(){this.__currentIndex!==null&&(this._selectionView.destroySelectionAt(this.__currentIndex),this.__currentIndex=null)},tuna.ui.selection.rule.MultipleSelectionRule=function(){tuna.ui.selection.rule.AbstractSelectionRule.call(this),this.__selectedIndexes=[]},tuna.utils.extend(tuna.ui.selection.rule.MultipleSelectionRule,tuna.ui.selection.rule.AbstractSelectionRule),tuna.ui.selection.rule.MultipleSelectionRule.prototype.getSelectedIndexes=function(){return tuna.utils.cloneArray(this.__selectedIndexes)},tuna.ui.selection.rule.MultipleSelectionRule.prototype.selectIndex=function(a){if(this.isIndexEnabled(a)){var b=tuna.utils.indexOf(a,this.__selectedIndexes);if(b===-1){if(this._eventDispatcher.dispatch("select",a))return this._selectionView.applySelectionAt(a),this.__selectedIndexes.push(a),!0}else if(this._eventDispatcher.dispatch("deselect",a))return this._selectionView.destroySelectionAt(a),this.__selectedIndexes.splice(b,1),!0}return!1},tuna.ui.selection.rule.MultipleSelectionRule.prototype.isSelected=function(a){return tuna.utils.indexOf(a,this.__selectedIndexes)!==-1},tuna.ui.selection.rule.MultipleSelectionRule.prototype.clearSelection=function(){while(this.__selectedIndexes.length>0)this._selectionView.destroySelectionAt(this.__selectedIndexes.shift())},tuna.ui.selection.rule.NavigationSelectionRule=function(){tuna.ui.selection.rule.AbstractSelectionRule.call(this),this.__currentIndex=null,this.__currentController=null,this.__navigation=null,this.__openData=null},tuna.utils.extend(tuna.ui.selection.rule.NavigationSelectionRule,tuna.ui.selection.rule.AbstractSelectionRule),tuna.ui.selection.rule.NavigationSelectionRule.prototype.setNavigation=function(a){this.__navigation=a},tuna.ui.selection.rule.NavigationSelectionRule.prototype.getSelectedIndexes=function(){return this.__currentIndex!==null?[this.__currentIndex]:[]},tuna.ui.selection.rule.NavigationSelectionRule.prototype.getCurrentIndex=function(){return this.__currentIndex},tuna.ui.selection.rule.NavigationSelectionRule.prototype.getCurrentController=function(){return this.__currentController},tuna.ui.selection.rule.NavigationSelectionRule.prototype.getOpenData=function(){return this.__openData},tuna.ui.selection.rule.NavigationSelectionRule.prototype.navigate=function(a,b){return this.__openData=b,this.selectIndex(a)},tuna.ui.selection.rule.NavigationSelectionRule.prototype.selectIndex=function(a){return this.isIndexEnabled(a)&&this.__currentIndex!==a?(this.__currentIndex!==null&&(this.__currentController instanceof tuna.control.PageViewController&&this.__currentController.canClose(a)&&this.__currentController instanceof tuna.control.PageViewController&&this.__currentController.close(),this._selectionView.destroySelectionAt(this.__currentIndex),this._eventDispatcher.dispatch("close",this.__currentIndex)),this.__currentIndex=a,this.__updateController(),this._selectionView.applySelectionAt(this.__currentIndex),this._eventDispatcher.dispatch("open",this.__currentIndex),this.__currentController!==null&&this.__currentController instanceof tuna.control.PageViewController&&this.__currentController.open(this.__openData),!0):!1},tuna.ui.selection.rule.NavigationSelectionRule.prototype.__updateController=function(){this.__currentController=null;if(this.__currentIndex!==null){var a=this._itemsCollection.getItemAt(this.__currentIndex);a!==null&&(this.__currentController=tuna.control.getController(a.id),this.__currentController!==null&&!this.__currentController.isActive()&&(this.__currentController instanceof tuna.control.PageViewController&&this.__currentController.setNavigation(this.__navigation),this.__currentController.init(a)))}},tuna.ui.selection.rule.NavigationSelectionRule.prototype.isSelected=function(a){return a===this.__currentIndex},tuna.ui.selection.rule.NavigationSelectionRule.prototype.clearSelection=function(){this.__currentIndex!==null&&(this._selectionView.destroySelectionAt(this.__currentIndex),this.__currentIndex=null)},tuna.ui.selection.view.ISelectionView=function(){},tuna.ui.selection.view.ISelectionView.prototype.applySelectionAt=function(a){},tuna.ui.selection.view.ISelectionView.prototype.destroySelectionAt=function(a){},tuna.ui.selection.view.ISelectionView.prototype.disableItemAt=function(a){},tuna.ui.selection.view.ISelectionView.prototype.enableItemAt=function(a){},tuna.ui.selection.view.ISelectionView.prototype.update=function(){},tuna.ui.selection.view.AbstractSelectionView=function(){this._itemsCollection=null,this._selectionRule=null},tuna.ui.selection.view.AbstractSelectionView.prototype.setSelectionRule=function(a){this._selectionRule=a},tuna.ui.selection.view.AbstractSelectionView.prototype.setItemsCollection=function(a){this._itemsCollection=a},tuna.ui.selection.view.AbstractSelectionView.prototype.applySelectionAt=function(a){},tuna.ui.selection.view.AbstractSelectionView.prototype.destroySelectionAt=function(a){},tuna.ui.selection.view.AbstractSelectionView.prototype.disableItemAt=function(a){},tuna.ui.selection.view.AbstractSelectionView.prototype.enableItemAt=function(a){},tuna.ui.selection.view.AbstractSelectionView.prototype.update=function(){},tuna.ui.selection.view.ClassSelectionView=function(a){tuna.ui.selection.view.AbstractSelectionView.call(this),this._target=a,this._itemSelector=null,this._selectionClass=null,this._disabledClass="disabled"},tuna.utils.extend(tuna.ui.selection.view.ClassSelectionView,tuna.ui.selection.view.AbstractSelectionView),tuna.ui.selection.view.ClassSelectionView.prototype.setItemSelector=function(a){this._itemSelector=a},tuna.ui.selection.view.ClassSelectionView.prototype.setSelectionClass=function(a){this._selectionClass=a},tuna.ui.selection.view.ClassSelectionView.prototype.setDisabledClass=function(a){this._disabledClass=a},tuna.ui.selection.view.ClassSelectionView.prototype.applySelectionAt=function(a){var b=this._itemsCollection.getItemAt(a);b!==null&&this._selectionClass!==null&&tuna.dom.addClass(b,this._selectionClass)},tuna.ui.selection.view.ClassSelectionView.prototype.destroySelectionAt=function(a){var b=this._itemsCollection.getItemAt(a);b!==null&&this._selectionClass!==null&&tuna.dom.removeClass(b,this._selectionClass)},tuna.ui.selection.view.ClassSelectionView.prototype.disableItemAt=function(a){var b=this._itemsCollection.getItemAt(a);b!==null&&this._disabledClass!==null&&tuna.dom.addClass(b,this._disabledClass)},tuna.ui.selection.view.ClassSelectionView.prototype.enableItemAt=function(a){var b=this._itemsCollection.getItemAt(a);b!==null&&this._disabledClass!==null&&tuna.dom.removeClass(b,this._disabledClass)},tuna.ui.selection.view.ClassSelectionView.prototype.update=function(){if(this._itemSelector!==null){this._selectionRule.clearSelection(),this._itemsCollection.clear();var a=tuna.dom.select(this._itemSelector,this._target),b=0,c=a.length,d=null,e=null;while(b<c)e=a[b],tuna.dom.getParentMatches(e,this._itemSelector,this._target)===null&&(d=this._itemsCollection.addItem(e),d!==null&&this._selectionClass!==null&&tuna.dom.hasClass(e,this._selectionClass)&&this._selectionRule.selectIndex(d)),b++}},tuna.control.setMainController=function(a){tuna.control.__mainController=a},tuna.control.registerController=function(a,b){tuna.control.__controllerTable[a]=b},tuna.control.getController=function(a){return tuna.control.__controllerTable[a]!==undefined?tuna.control.__controllerTable[a]:null},tuna.control.init=function(a){tuna.control.__mainController.init(a)},tuna.control.__controllerTable={},tuna.control.__mainController=null,tuna.control.ViewController=function(){this._container=null,this._modules=[]},tuna.control.ViewController.prototype.isActive=function(){return this._container!==null&&this._container.isActive()},tuna.control.ViewController.prototype.init=function(a){this.destroy(),this._container=new tuna.ui.ModuleContainer(a),this._container.requireModules(this._modules),this._container.init(),this._initActions()},tuna.control.ViewController.prototype.destroy=function(){this._container!==null&&(this._destroyActions(),this._container.destroy(),this._container=null)},tuna.control.ViewController.prototype._initActions=function(){},tuna.control.ViewController.prototype._destroyActions=function(){},tuna.control.ViewController.prototype.handleTransformComplete=function(a,b,c){var d=0,e=b.length;while(d<e)this._container.initModules(b[d]),d++;d=0,e=c.length;while(d<e)this._container.destroyModules(c[d]),d++},tuna.control.ViewController.prototype.handleTransformStart=function(a){},tuna.control.PageViewController=function(){tuna.control.ViewController.call(this),this._navigation=null},tuna.utils.extend(tuna.control.PageViewController,tuna.control.ViewController),tuna.control.PageViewController.prototype.setNavigation=function(a){this._navigation=a},tuna.control.PageViewController.prototype.canClose=function(a){return!0},tuna.control.PageViewController.prototype.close=function(){},tuna.control.PageViewController.prototype.open=function(a){};var NavigationModule=function(){tuna.ui.Module.call(this,".j-navigation")};tuna.utils.extend(NavigationModule,tuna.ui.Module),NavigationModule.prototype.initInstance=function(a){return new tuna.ui.selection.Navigation(a)},tuna.ui.registerModule("navigation",new NavigationModule);var PopupModule=function(){tuna.ui.Module.call(this,".j-popup")};tuna.utils.extend(PopupModule,tuna.ui.Module),PopupModule.prototype.initInstance=function(a){return tuna.ui.popups.create(a)},tuna.ui.registerModule("popup",new PopupModule);var ButtonModule=function(){tuna.ui.Module.call(this,".j-button")};tuna.utils.extend(ButtonModule,tuna.ui.Module),ButtonModule.prototype.initInstance=function(a){return tuna.ui.buttons.create(a)},tuna.ui.registerModule("button",new ButtonModule);var PopupButtonModule=function(){tuna.ui.Module.call(this,".j-popup-button")};tuna.utils.extend(PopupButtonModule,tuna.ui.Module),PopupButtonModule.prototype.initInstance=function(a){return new tuna.ui.buttons.PopupButton(a)},tuna.ui.registerModule("popup-button",new PopupButtonModule);var SelectionGroupModule=function(){tuna.ui.Module.call(this,".j-selection-group")};tuna.utils.extend(SelectionGroupModule,tuna.ui.Module),SelectionGroupModule.prototype.initInstance=function(a){var b=new tuna.ui.selection.SelectionGroup(a,null),c=b.getStringOption("selection-event"),d=b.getStringOption("item-selector");return c!==null&&d!==null&&tuna.dom.addChildEventListener(a,d,c,function(){var a=b.getItemIndex(this);a!==null&&b.selectIndex(a)}),b},tuna.ui.registerModule("selection-group",new SelectionGroupModule);var TemplateTransformerModule=function(){tuna.ui.Module.call(this,".j-template-transformer")};tuna.utils.extend(TemplateTransformerModule,tuna.ui.Module),TemplateTransformerModule.prototype.initInstance=function(a){return new tuna.ui.transformers.TemplateTransformer(a)},tuna.ui.registerModule("template-transformer",new TemplateTransformerModule);var ButtonGroupModule=function(){tuna.ui.Module.call(this,".j-button-group")};tuna.utils.extend(ButtonGroupModule,tuna.ui.Module),ButtonGroupModule.prototype.initInstance=function(a){return new tuna.ui.buttons.ButtonGroup(a)},tuna.ui.registerModule("button-group",new ButtonGroupModule);var SWFModule=function(){tuna.ui.Module.call(this,".j-swf")};tuna.utils.extend(SWFModule,tuna.ui.Module),SWFModule.prototype.initInstance=function(a){return new tuna.ui.flash.SWF(a)},tuna.ui.registerModule("swf",new SWFModule);var InputFilterModule=function(){tuna.ui.Module.call(this,".j-input-filter")};tuna.utils.extend(InputFilterModule,tuna.ui.Module),InputFilterModule.prototype.initInstance=function(a){return new tuna.ui.forms.InputFilter(a)},tuna.ui.registerModule("input-filter",new InputFilterModule);var AutocompleteModule=function(){tuna.ui.Module.call(this,".j-autocomplete")};tuna.utils.extend(AutocompleteModule,tuna.ui.Module),AutocompleteModule.prototype.initInstance=function(a){return new tuna.ui.forms.Autocomplete(a)},tuna.ui.registerModule("autocomplete",new AutocompleteModule);var FormModule=function(){tuna.ui.Module.call(this,"form.j-form")};tuna.utils.extend(FormModule,tuna.ui.Module),FormModule.prototype.initInstance=function(a){return new tuna.ui.forms.Form(a)},tuna.ui.registerModule("form",new FormModule);var CarouselModule=function(){tuna.ui.Module.call(this,".j-carousel")};tuna.utils.extend(CarouselModule,tuna.ui.Module),CarouselModule.prototype.initInstance=function(a){return new tuna.ui.selection.Carousel(a)},tuna.ui.registerModule("carousel",new CarouselModule)